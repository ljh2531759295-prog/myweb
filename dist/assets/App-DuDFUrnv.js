import{_ as ue,r as b,c as g,b as e,n as G,d as te,h as ye,e as q,t as k,o as d,i as Ce,j as ze,F as ce,k as de,w as se,l as We,m as pt,p as Te,v as Ne,q as bt,u as He,s as Ge,g as H,x as vt,f as Mt,y as ns,z as $e}from"./index-GoinUiKB.js";const is=["title"],rs={class:"sidebar-header"},cs={class:"logo"},ds={class:"logo-text"},us={class:"sidebar-nav"},vs={class:"nav-section"},gs={class:"section-title"},ps={class:"nav-list"},ys=["title"],hs={class:"nav-text"},ms={key:0,class:"nav-badge"},fs={class:"nav-item"},bs=["title"],ws={class:"nav-text"},ks={class:"nav-item"},$s=["title"],Cs={class:"nav-text"},Ss=["title"],Is={class:"nav-text"},Ms={class:"nav-item"},xs=["title"],_s={class:"nav-text"},Ps={class:"nav-section"},Ls={class:"section-title"},Ds={class:"nav-list"},As=["title"],Us={class:"nav-text"},Ts=["title"],Fs={class:"nav-text"},zs={key:0,class:"nav-badge"},Ns=["title"],js={class:"nav-text"},Bs={class:"sidebar-footer"},Rs={key:0,class:"playlist-stats"},Es={class:"stats-text"},Os={class:"bottom-controls"},qs=["title"],Vs={class:"control-text"},Hs=["title"],Gs={class:"control-icon theme-icon"},Ws={__name:"Sidebar",props:{songCount:{type:Number,default:0},favoriteCount:{type:Number,default:0},playlistCount:{type:Number,default:0},currentView:{type:String,default:"library"},isDarkMode:{type:Boolean,default:!1}},emits:["navigate","show-add-music","show-resource-manager","clear-playlist","sidebar-collapsed","toggle-theme","show-settings"],setup(a,{emit:c}){const n=c,s=b(!1),r=()=>{s.value=!s.value,n("sidebar-collapsed",s.value)};return(i,o)=>(d(),g("div",{class:G(["sidebar",{collapsed:s.value}])},[e("button",{class:"collapse-button",onClick:r,title:s.value?"Â±ïÂºÄ‰æßËæπÊ†è":"Êî∂Ëµ∑‰æßËæπÊ†è"},[e("span",{class:G(["collapse-icon",{rotated:s.value}])},"‚óÄ",2)],8,is),e("div",rs,[e("div",cs,[te(e("span",ds,"Èü≥‰πêÊí≠ÊîæÂô®",512),[[ye,!s.value]])])]),e("nav",us,[e("div",vs,[te(e("h3",gs,"Èü≥‰πêÂ∫ì",512),[[ye,!s.value]]),e("ul",ps,[e("li",{class:G(["nav-item",{active:a.currentView==="library"}])},[e("button",{class:"nav-button",onClick:o[0]||(o[0]=u=>i.$emit("navigate","library")),title:s.value?"ÊàëÁöÑÈü≥‰πê":""},[o[10]||(o[10]=e("span",{class:"nav-icon"},"üé∂",-1)),te(e("span",hs,"ÊàëÁöÑÈü≥‰πê",512),[[ye,!s.value]]),a.songCount>0&&!s.value?(d(),g("span",ms,k(a.songCount),1)):q("",!0)],8,ys)],2),e("li",fs,[e("button",{class:"nav-button",onClick:o[1]||(o[1]=u=>i.$emit("show-add-music")),title:s.value?"Ê∑ªÂä†Èü≥‰πê":""},[o[11]||(o[11]=e("span",{class:"nav-icon"},"‚ûï",-1)),te(e("span",ws,"Ê∑ªÂä†Èü≥‰πê",512),[[ye,!s.value]])],8,bs)]),e("li",ks,[e("button",{class:"nav-button",onClick:o[2]||(o[2]=u=>i.$emit("show-search")),title:s.value?"ÊêúÁ¥¢Èü≥‰πê":""},[o[12]||(o[12]=e("span",{class:"nav-icon"},"üîç",-1)),te(e("span",Cs,"ÊêúÁ¥¢Èü≥‰πê",512),[[ye,!s.value]])],8,$s)]),e("li",{class:G(["nav-item",{active:a.currentView==="online-music"}])},[e("button",{class:"nav-button",onClick:o[3]||(o[3]=u=>i.$emit("navigate","online-music")),title:s.value?"ÁΩëÊòì‰∫ëÂú®Á∫øÊêúÁ¥¢":""},[o[13]||(o[13]=e("span",{class:"nav-icon"},"üéµ",-1)),te(e("span",Is,"ÁΩëÊòì‰∫ëÂú®Á∫øÊêúÁ¥¢",512),[[ye,!s.value]])],8,Ss)],2),e("li",Ms,[e("button",{class:"nav-button",onClick:o[4]||(o[4]=u=>i.$emit("show-resource-manager")),title:s.value?"ËµÑÊ∫êÁÆ°ÁêÜ":""},[o[14]||(o[14]=e("span",{class:"nav-icon"},"üóÇÔ∏è",-1)),te(e("span",_s,"ËµÑÊ∫êÁÆ°ÁêÜ",512),[[ye,!s.value]])],8,xs)])])]),e("div",Ps,[te(e("h3",Ls,"Êí≠ÊîæÂàóË°®",512),[[ye,!s.value]]),e("ul",Ds,[e("li",{class:G(["nav-item",{active:a.currentView==="favorites"}])},[e("button",{class:"nav-button",onClick:o[5]||(o[5]=u=>i.$emit("navigate","favorites")),title:s.value?"ÊàëÂñúÊ¨¢ÁöÑ":""},[o[15]||(o[15]=e("span",{class:"nav-icon"},"‚ù§Ô∏è",-1)),te(e("span",Us,"ÊàëÂñúÊ¨¢ÁöÑ",512),[[ye,!s.value]])],8,As)],2),e("li",{class:G(["nav-item",{active:a.currentView==="playlists"}])},[e("button",{class:"nav-button",onClick:o[6]||(o[6]=u=>i.$emit("navigate","playlists")),title:s.value?"ÊàëÁöÑÊ≠åÂçï":""},[o[16]||(o[16]=e("span",{class:"nav-icon"},"üìã",-1)),te(e("span",Fs,"ÊàëÁöÑÊ≠åÂçï",512),[[ye,!s.value]]),a.playlistCount>0&&!s.value?(d(),g("span",zs,k(a.playlistCount),1)):q("",!0)],8,Ts)],2),e("li",{class:G(["nav-item",{active:a.currentView==="recent"}])},[e("button",{class:"nav-button",onClick:o[7]||(o[7]=u=>i.$emit("navigate","recent")),title:s.value?"ÈöèÊú∫Ê≠åÊõ≤":""},[o[17]||(o[17]=e("span",{class:"nav-icon"},"üé≤",-1)),te(e("span",js,"ÈöèÊú∫Ê≠åÊõ≤",512),[[ye,!s.value]])],8,Ns)],2)])])]),e("div",Bs,[a.songCount>0&&!s.value?(d(),g("div",Rs,[e("p",Es,"ÊÄªËÆ° "+k(a.songCount)+" È¶ñÊ≠åÊõ≤",1)])):q("",!0),e("div",Os,[e("button",{class:"control-btn",onClick:o[8]||(o[8]=u=>i.$emit("show-settings")),title:s.value?"Áî®Êà∑ËÆæÁΩÆ":""},[o[18]||(o[18]=e("span",{class:"control-icon"},"‚öôÔ∏è",-1)),te(e("span",Vs,"ËÆæÁΩÆ",512),[[ye,!s.value]])],8,qs),e("button",{class:"control-btn theme-btn",onClick:o[9]||(o[9]=u=>i.$emit("toggle-theme")),title:s.value?a.isDarkMode?"ÂàáÊç¢Âà∞Êó•Èó¥Ê®°Âºè":"ÂàáÊç¢Âà∞Â§úÊôöÊ®°Âºè":""},[e("span",Gs,k(a.isDarkMode?"‚òÄÔ∏è":"üåô"),1),te(e("span",{class:"control-text theme-text"},k(a.isDarkMode?"Êó•Èó¥Ê®°Âºè":"Â§úÊôöÊ®°Âºè"),513),[[ye,!s.value]])],8,Hs)])])],2))}},Zs=ue(Ws,[["__scopeId","data-v-7ae18948"]]),Ys=["onClick"],Ks={class:"song-count"},Qs={__name:"ContextMenu",props:{visible:{type:Boolean,default:!1},position:{type:Object,default:()=>({x:0,y:0})},song:{type:Object,default:null},playlists:{type:Array,default:()=>[]}},emits:["delete-song","add-to-playlist","edit-song","close"],setup(a,{emit:c}){const n=a,s=c,r=b(!1),i=Ce(()=>({top:"0px",left:"100%"})),o=()=>{r.value=!r.value},u=U=>{n.song&&s("add-to-playlist",n.song,U),s("close")},f=()=>{n.song&&s("edit-song",n.song),s("close")},F=()=>{n.song&&s("delete-song",n.song),s("close")};return(U,M)=>a.visible?(d(),g("div",{key:0,class:"context-menu",style:ze({top:a.position.y+"px",left:a.position.x+"px"}),onClick:M[0]||(M[0]=se(()=>{},["stop"]))},[e("div",{class:"menu-item",onClick:f},M[1]||(M[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})],-1),e("span",null,"ÁºñËæë‰ø°ÊÅØ",-1)])),a.playlists.length>0?(d(),g("div",{key:0,class:"menu-item",onClick:o},M[2]||(M[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M14 10H2v2h12v-2zm0-4H2v2h12V6zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zM2 16h8v-2H2v2z"})],-1),e("span",null,"Âä†ÂÖ•Ê≠åÂçï",-1),e("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",class:"arrow-icon"},[e("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})],-1)]))):q("",!0),e("div",{class:"menu-item",onClick:F},M[3]||(M[3]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})],-1),e("span",null,"Âà†Èô§Ê≠åÊõ≤",-1)])),r.value?(d(),g("div",{key:1,class:"submenu",style:ze(i.value)},[(d(!0),g(ce,null,de(a.playlists,h=>(d(),g("div",{key:h.id,class:"submenu-item",onClick:$=>u(h)},[M[4]||(M[4]=e("div",{class:"playlist-icon"},"üìã",-1)),e("span",null,k(h.name),1),e("span",Ks,"("+k(h.songs.length)+")",1)],8,Ys))),128))],4)):q("",!0)],4)):q("",!0)}},xt=ue(Qs,[["__scopeId","data-v-b4cabe1d"]]),Js={class:"song-list-container"},Xs=["onClick","onContextmenu"],el={class:"song-controls"},tl=["onClick","title"],sl={class:"cover-container"},ll=["src"],ol={class:"song-info"},al={class:"song-title"},nl={class:"song-artist"},il={__name:"SongList",props:{playlist:Array,currentSong:Object,getCoverUrl:Function,isPlaying:Boolean,playlists:{type:Array,default:()=>[]}},emits:["play-song","toggle-favorite","delete-song","add-to-playlist","edit-song"],setup(a,{emit:c}){const n=c,s=b({visible:!1,position:{x:0,y:0},song:null}),r=h=>{n("play-song",h)},i=h=>{n("toggle-favorite",h)},o=(h,$)=>{h.preventDefault(),s.value={visible:!0,position:{x:h.clientX,y:h.clientY},song:$}},u=()=>{s.value.visible=!1},f=h=>{n("delete-song",h),u()},F=(h,$)=>{n("add-to-playlist",h,$),u()},U=h=>{n("edit-song",h),u()},M=h=>{s.value.visible&&u()};return We(()=>{document.addEventListener("click",M)}),pt(()=>{document.removeEventListener("click",M)}),(h,$)=>(d(),g("div",Js,[e("div",{class:"songs-grid",onClick:u},[(d(!0),g(ce,null,de(a.playlist,w=>(d(),g("div",{key:w.id,class:G(["song-card",{active:a.currentSong?.id===w.id,playing:a.currentSong?.id===w.id&&a.isPlaying}]),onClick:S=>r(w),onContextmenu:se(S=>o(S,w),["prevent"])},[e("div",el,[e("button",{class:G(["control-btn favorite",{active:w.isFavorite}]),onClick:se(S=>i(w),["stop"]),title:w.isFavorite?"ÂèñÊ∂àÊî∂Ëóè":"Êî∂Ëóè"},k(w.isFavorite?"‚ô•":"‚ô°"),11,tl)]),e("div",sl,[e("img",{src:a.getCoverUrl(w.cover),class:G(["cover",{"cd-spinning":a.currentSong?.id===w.id&&a.isPlaying}]),alt:"Ê≠åÊõ≤Â∞ÅÈù¢"},null,10,ll)]),e("div",ol,[e("h3",al,k(w.title),1),e("p",nl,k(w.artist),1)])],42,Xs))),128))]),Te(xt,{visible:s.value.visible,position:s.value.position,song:s.value.song,playlists:a.playlists,onDeleteSong:f,onAddToPlaylist:F,onEditSong:U,onClose:u},null,8,["visible","position","song","playlists"])]))}},gt=ue(il,[["__scopeId","data-v-37402e5d"]]),rl=["audio/mpeg","audio/mp4","audio/wav","audio/flac","audio/ogg","audio/webm","audio/aac"],cl=["image/jpeg","image/png","image/webp","image/gif"];function dl(a){return rl.includes(a.type)}function ul(a){return cl.includes(a.type)}function vl(a){const c=a.name.toLowerCase();return c.endsWith(".lrc")||c.endsWith(".txt")}function Fe(a){if(a===0)return"0 Bytes";const c=1024,n=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(a)/Math.log(c));return parseFloat((a/Math.pow(c,s)).toFixed(2))+" "+n[s]}function gl(a){if(!a||isNaN(a))return"0:00";const c=Math.floor(a/60),n=Math.floor(a%60);return`${c}:${n<10?"0":""}${n}`}function ne(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function wt(a){const c=a.replace(/\.[^/.]+$/,""),n=c.split(" - ");return n.length>=2?{artist:n[0].trim(),title:n.slice(1).join(" - ").trim()}:{artist:"Êú™Áü•Ëâ∫ÊúØÂÆ∂",title:c.trim()}}function kt(a){return new Promise(c=>{const n=new Audio,s=URL.createObjectURL(a);n.addEventListener("loadedmetadata",()=>{const r=n.duration;URL.revokeObjectURL(s);const{artist:i,title:o}=wt(a.name);c({title:o,artist:i,duration:gl(r),durationSeconds:r,fileSize:Fe(a.size),format:a.type})}),n.addEventListener("error",()=>{URL.revokeObjectURL(s);const{artist:r,title:i}=wt(a.name);c({title:i,artist:r,duration:"0:00",durationSeconds:0,fileSize:Fe(a.size),format:a.type})}),n.src=s})}function $t(a){return new Promise((c,n)=>{const s=new FileReader;s.onload=r=>c(r.target.result),s.onerror=n,s.readAsDataURL(a)})}function Ct(a){return URL.createObjectURL(a)}function pl(a){const c=[],n=[],s=[],r=[];return Array.from(a).forEach(i=>{dl(i)?c.push(i):ul(i)?n.push(i):vl(i)?s.push(i):r.push(i)}),{audioFiles:c,imageFiles:n,lyricsFiles:s,invalidFiles:r}}class yl{constructor(){this.dbName="MusicPlayerAssets",this.version=4,this.db=null}async init(){return new Promise((c,n)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>n(s.error),s.onsuccess=()=>{this.db=s.result,c(this.db)},s.onupgradeneeded=r=>{const i=r.target.result;if(i.objectStoreNames.contains("songs")||i.createObjectStore("songs",{keyPath:"id"}).createIndex("filename","filename",{unique:!0}),i.objectStoreNames.contains("covers")||i.createObjectStore("covers",{keyPath:"id"}).createIndex("filename","filename",{unique:!0}),i.objectStoreNames.contains("lyrics")||i.createObjectStore("lyrics",{keyPath:"id"}).createIndex("filename","filename",{unique:!0}),i.objectStoreNames.contains("settings")||i.createObjectStore("settings",{keyPath:"key"}),!i.objectStoreNames.contains("musicLibrary")){const o=i.createObjectStore("musicLibrary",{keyPath:"id"});o.createIndex("title","title",{unique:!1}),o.createIndex("artist","artist",{unique:!1})}i.objectStoreNames.contains("playlists")||i.createObjectStore("playlists",{keyPath:"id"}).createIndex("name","name",{unique:!1})}})}async saveFile(c,n,s){return this.db||await this.init(),new Promise((r,i)=>{const o=new FileReader;o.onload=()=>{try{if(!this.db.objectStoreNames.contains(n)){i(new Error(`Object store '${n}' not found. Available stores: ${Array.from(this.db.objectStoreNames).join(", ")}`));return}const f=this.db.transaction([n],"readwrite").objectStore(n),F={id:ne(),filename:s,data:o.result,originalName:c.name,type:c.type,size:c.size,createdAt:new Date().toISOString()},U=f.add(F);U.onsuccess=()=>r(F),U.onerror=()=>i(U.error)}catch(u){i(u)}},o.onerror=()=>i(o.error),o.readAsArrayBuffer(c)})}async getFile(c,n){return this.db||await this.init(),new Promise((s,r)=>{const f=this.db.transaction([c],"readonly").objectStore(c).index("filename").get(n);f.onsuccess=()=>{if(f.result){const F=new Blob([f.result.data],{type:f.result.type}),U=URL.createObjectURL(F);s(U)}else s(null)},f.onerror=()=>r(f.error)})}async getFileBlob(c,n){return this.db||await this.init(),new Promise((s,r)=>{const f=this.db.transaction([c],"readonly").objectStore(c).index("filename").get(n);f.onsuccess=()=>{if(f.result){const F=new Blob([f.result.data],{type:f.result.type});s(F)}else s(null)},f.onerror=()=>r(f.error)})}async getAllFiles(c){return this.db||await this.init(),new Promise((n,s)=>{const o=this.db.transaction([c],"readonly").objectStore(c).getAll();o.onsuccess=()=>n(o.result),o.onerror=()=>s(o.error)})}async deleteFile(c,n){return this.db||await this.init(),new Promise((s,r)=>{const o=this.db.transaction([c],"readwrite").objectStore(c),f=o.index("filename").get(n);f.onsuccess=()=>{if(f.result){const F=o.delete(f.result.id);F.onsuccess=()=>s(!0),F.onerror=()=>r(F.error)}else s(!1)},f.onerror=()=>r(f.error)})}async exportAssets(){const c=await this.getAllFiles("songs"),n=await this.getAllFiles("covers");return{songs:c.map(s=>({filename:s.filename,originalName:s.originalName,type:s.type,size:s.size,createdAt:s.createdAt})),covers:n.map(s=>({filename:s.filename,originalName:s.originalName,type:s.type,size:s.size,createdAt:s.createdAt}))}}async downloadFile(c,n){return this.db||await this.init(),new Promise((s,r)=>{const f=this.db.transaction([c],"readonly").objectStore(c).index("filename").get(n);f.onsuccess=()=>{if(f.result){const F=new Blob([f.result.data],{type:f.result.type}),U=URL.createObjectURL(F),M=document.createElement("a");M.href=U,M.download=f.result.originalName,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(U),s(!0)}else s(!1)},f.onerror=()=>r(f.error)})}async saveSetting(c,n){return this.db||await this.init(),new Promise((s,r)=>{const o=this.db.transaction(["settings"],"readwrite").objectStore("settings"),u={key:c,value:n,updatedAt:new Date().toISOString()},f=o.put(u);f.onsuccess=()=>s(u),f.onerror=()=>r(f.error)})}async getSetting(c,n=null){return this.db||await this.init(),new Promise((s,r)=>{const u=this.db.transaction(["settings"],"readonly").objectStore("settings").get(c);u.onsuccess=()=>{u.result?s(u.result.value):s(n)},u.onerror=()=>r(u.error)})}async deleteSetting(c){return this.db||await this.init(),new Promise((n,s)=>{const o=this.db.transaction(["settings"],"readwrite").objectStore("settings").delete(c);o.onsuccess=()=>n(!0),o.onerror=()=>s(o.error)})}async getAllSettings(){return this.db||await this.init(),new Promise((c,n)=>{const i=this.db.transaction(["settings"],"readonly").objectStore("settings").getAll();i.onsuccess=()=>{const o={};i.result.forEach(u=>{o[u.key]=u.value}),c(o)},i.onerror=()=>n(i.error)})}async saveTheme(c){return await this.saveSetting("theme",c?"dark":"light")}async getTheme(){return await this.getSetting("theme","light")}async saveMusicLibrary(c){return this.db||await this.init(),new Promise((n,s)=>{const i=this.db.transaction(["musicLibrary"],"readwrite").objectStore("musicLibrary"),o=i.clear();o.onsuccess=()=>{let u=0;const f=c.length;if(f===0){n([]);return}c.forEach(F=>{const U=i.add({...F,updatedAt:new Date().toISOString()});U.onsuccess=()=>{u++,u===f&&n(c)},U.onerror=()=>s(U.error)})},o.onerror=()=>s(o.error)})}async getMusicLibrary(){return this.db||await this.init(),new Promise((c,n)=>{const i=this.db.transaction(["musicLibrary"],"readonly").objectStore("musicLibrary").getAll();i.onsuccess=()=>c(i.result||[]),i.onerror=()=>n(i.error)})}async savePlaylists(c){return this.db||await this.init(),new Promise((n,s)=>{const i=this.db.transaction(["playlists"],"readwrite").objectStore("playlists"),o=i.clear();o.onsuccess=()=>{let u=0;const f=c.length;if(f===0){n([]);return}c.forEach(F=>{const U=i.add({...F,updatedAt:new Date().toISOString()});U.onsuccess=()=>{u++,u===f&&n(c)},U.onerror=()=>s(U.error)})},o.onerror=()=>s(o.error)})}async getPlaylists(){return this.db||await this.init(),new Promise((c,n)=>{const i=this.db.transaction(["playlists"],"readonly").objectStore("playlists").getAll();i.onsuccess=()=>c(i.result||[]),i.onerror=()=>n(i.error)})}async migrateFromLocalStorage(){try{const c=localStorage.getItem("musicplayer_playlist");if(c){const s=JSON.parse(c);await this.saveMusicLibrary(s),localStorage.removeItem("musicplayer_playlist"),console.log("Èü≥‰πêÂ∫ìÊï∞ÊçÆÂ∑≤ËøÅÁßªÂà∞IndexedDB")}const n=localStorage.getItem("musicplayer_playlists");if(n){const s=JSON.parse(n);await this.savePlaylists(s),localStorage.removeItem("musicplayer_playlists"),console.log("Êí≠ÊîæÂàóË°®Êï∞ÊçÆÂ∑≤ËøÅÁßªÂà∞IndexedDB")}}catch(c){console.error("Êï∞ÊçÆËøÅÁßªÂ§±Ë¥•:",c)}}}const V=new yl,hl={class:"upload-section"},ml={key:0,class:"upload-progress"},fl={class:"progress-bar"},bl={key:1,class:"batch-progress"},wl={class:"progress-bar"},kl={class:"batch-stats"},$l={key:0,class:"file-preview"},Cl={class:"file-list"},Sl={class:"file-info"},Il={class:"file-icon"},Ml={class:"file-details"},xl={key:0,class:"audio-inputs"},_l={class:"input-group"},Pl=["onUpdate:modelValue"],Ll={class:"input-group"},Dl=["onUpdate:modelValue"],Al={class:"input-group"},Ul=["onUpdate:modelValue"],Tl=["value"],Fl=["onClick"],zl={class:"input-group"},Nl=["onUpdate:modelValue"],jl=["value"],Bl=["onClick"],Rl={class:"file-meta"},El={key:1,class:"image-info"},Ol={class:"file-meta"},ql={key:2,class:"lyrics-info"},Vl={class:"file-meta"},Hl={key:0,class:"lyrics-preview"},Gl=["onClick"],Wl={class:"upload-actions"},Zl=["disabled"],Yl=["disabled"],Kl=["disabled"],Ql={key:1,class:"error-message"},Jl={__name:"FileUpload",emits:["files-uploaded"],setup(a,{emit:c}){const n=c,s=b(!1),r=b(!1),i=b(0),o=b(""),u=b([]),f=b(null),F=b(null),U=b(null),M=b(null),h=b(-1),$=b(!1),w=b(0),S=b(""),T=b(0),K=b(0),O=Ce(()=>u.value.filter(P=>P.type==="image").map(P=>({id:P.id,name:P.name,url:P.url}))),N=Ce(()=>u.value.filter(P=>P.type==="lyrics").map(P=>({id:P.id,name:P.name,content:P.content}))),p=P=>{P.preventDefault()},x=P=>{P.preventDefault(),s.value=!0},D=P=>{P.preventDefault(),P.currentTarget.contains(P.relatedTarget)||(s.value=!1)},B=P=>{P.preventDefault(),s.value=!1;const I=P.dataTransfer.files;oe(I)},W=()=>{f.value.click()},z=P=>{const I=P.target.files;oe(I),P.target.value=""},Se=P=>{h.value=P,F.value.click()},ve=async P=>{const I=P.target.files[0];if(I)try{const L=await $t(I),A=ne(),R={id:A,type:"image",file:I,name:I.name,url:L,fileSize:Fe(I.size)};if(u.value.push(R),h.value>=0){const J=u.value.find((ae,Z)=>ae.type==="audio"&&Z===h.value);J&&(J.selectedCover=A)}}catch(L){o.value="Â∞ÅÈù¢‰∏ä‰º†Â§±Ë¥•ÔºåËØ∑ÈáçËØï",console.error("Â∞ÅÈù¢‰∏ä‰º†ÈîôËØØ:",L)}finally{h.value=-1,P.target.value=""}},Ie=P=>{console.log("Ëß¶ÂèëÊ≠åËØç‰∏ä‰º†ÔºåÈü≥È¢ëÁ¥¢Âºï:",P),console.log("lyricsInput.value:",U.value),console.log("pendingFiles.value:",u.value),h.value=P,setTimeout(()=>{if(U.value)console.log("ÊâæÂà∞lyricsInputÔºåËß¶ÂèëÁÇπÂáª"),U.value.click();else{console.error("lyricsInput ref Êú™ÊâæÂà∞");const I=document.querySelector('input[accept*=".lrc"]');I?(console.log("ÈÄöËøáquerySelectorÊâæÂà∞Ê≠åËØçËæìÂÖ•ÂÖÉÁ¥†"),I.click()):console.error("Êó†Ê≥ïÊâæÂà∞Ê≠åËØçËæìÂÖ•ÂÖÉÁ¥†")}},100)},je=async P=>{console.log("Â§ÑÁêÜÊ≠åËØçÈÄâÊã©");const I=P.target.files[0];if(!I){console.log("Ê≤°ÊúâÈÄâÊã©Êñá‰ª∂");return}console.log("ÈÄâÊã©ÁöÑÊ≠åËØçÊñá‰ª∂:",I.name);try{const L=await Ze(I);console.log("Ê≠åËØçÂÜÖÂÆπËØªÂèñÊàêÂäüÔºåÈïøÂ∫¶:",L.length);const A=L.split(`
`).slice(0,3).join(`
`)+"...",R=ne(),J={id:R,type:"lyrics",file:I,name:I.name,content:L,preview:A,fileSize:Fe(I.size)};if(u.value.push(J),console.log("Ê≠åËØçÊñá‰ª∂Â∑≤Ê∑ªÂä†Âà∞ÂæÖÂ§ÑÁêÜÂàóË°®"),h.value>=0){const ae=u.value.find((Z,ee)=>Z.type==="audio"&&ee===h.value);ae&&(ae.selectedLyrics=R,console.log("Â∑≤Ëá™Âä®‰∏∫Èü≥È¢ëÊñá‰ª∂ÈÄâÊã©Ê≠åËØç"))}}catch(L){o.value="Ê≠åËØç‰∏ä‰º†Â§±Ë¥•ÔºåËØ∑ÈáçËØï",console.error("Ê≠åËØç‰∏ä‰º†ÈîôËØØ:",L)}finally{h.value=-1,P.target.value=""}},oe=async P=>{if(P.length!==0){r.value=!0,i.value=0,o.value="";try{const{audioFiles:I,imageFiles:L,lyricsFiles:A,invalidFiles:R}=pl(P);R.length>0&&(o.value=`‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Ê†ºÂºè: ${R.map(Z=>Z.name).join(", ")}`);const J=I.length+L.length+A.length;let ae=0;for(const Z of I)try{const ee=await kt(Z),m=Ct(Z);u.value.push({id:ne(),type:"audio",file:Z,name:Z.name,url:m,selectedCover:"",selectedLyrics:"",...ee}),ae++,i.value=Math.round(ae/J*100)}catch(ee){console.error("Â§ÑÁêÜÈü≥È¢ëÊñá‰ª∂Â§±Ë¥•:",ee)}for(const Z of L)try{const ee=await $t(Z);u.value.push({id:ne(),type:"image",file:Z,name:Z.name,url:ee,fileSize:Z.size}),ae++,i.value=Math.round(ae/J*100)}catch(ee){console.error("Â§ÑÁêÜÂõæÁâáÊñá‰ª∂Â§±Ë¥•:",ee)}for(const Z of A)try{const ee=await Ze(Z),m=ee.split(`
`).slice(0,3).join(`
`)+"...";u.value.push({id:ne(),type:"lyrics",file:Z,name:Z.name,content:ee,preview:m,fileSize:Z.size}),ae++,i.value=Math.round(ae/J*100)}catch(ee){console.error("Â§ÑÁêÜÊ≠åËØçÊñá‰ª∂Â§±Ë¥•:",ee)}}catch(I){o.value="Êñá‰ª∂Â§ÑÁêÜÂ§±Ë¥•ÔºåËØ∑ÈáçËØï",console.error("Êñá‰ª∂Â§ÑÁêÜÈîôËØØ:",I)}finally{r.value=!1}}},Ze=P=>new Promise((I,L)=>{const A=new FileReader;A.onload=R=>{try{let J=R.target.result;if(P.name.toLowerCase().endsWith(".lrc"))I(J);else{const Z=J.split(`
`).filter(ee=>ee.trim()).map((ee,m)=>`[${String(Math.floor(m*5/60)).padStart(2,"0")}:${String(m*5%60).padStart(2,"0")}.00]${ee.trim()}`).join(`
`);I(Z)}}catch(J){L(J)}},A.onerror=()=>L(A.error),A.readAsText(P,"utf-8")}),Le=P=>{const I=u.value[P];I.url&&I.type==="audio"&&URL.revokeObjectURL(I.url),u.value.splice(P,1)},Me=()=>{u.value.forEach(P=>{P.url&&P.type==="audio"&&URL.revokeObjectURL(P.url)}),u.value=[]},Je=()=>{if(u.value.length===0)return;if(u.value.filter(A=>A.type==="audio").filter(A=>!A.title?.trim()||!A.artist?.trim()).length>0){o.value="ËØ∑‰∏∫ÊâÄÊúâÈü≥È¢ëÊñá‰ª∂Â°´ÂÜôÂÆåÊï¥‰ø°ÊÅØÔºàÊ≠åÊõ≤ÂêçÁß∞„ÄÅÊ≠åÊâãÔºâ";return}const L=u.value.map(A=>{if(A.type==="audio"&&A.selectedLyrics){const R=u.value.find(J=>J.id===A.selectedLyrics);return console.log("‰∏∫Èü≥È¢ëÊñá‰ª∂Ê∑ªÂä†Ê≠åËØç:",A.title,"Ê≠åËØçID:",A.selectedLyrics),console.log("ÊâæÂà∞ÁöÑÊ≠åËØçÊñá‰ª∂:",R?.name),{...A,lyricsContent:R?.content||null}}return A});console.log("Â§ÑÁêÜÂêéÁöÑÊñá‰ª∂ÂàóË°®:",L),n("files-uploaded",L),Me()},ie=()=>{o.value=""},Ye=()=>{console.log("ÊµãËØïÊ≠åËØç‰∏ä‰º†ÊåâÈíÆË¢´ÁÇπÂáª"),h.value=-1,setTimeout(()=>{U.value?(console.log("ÊâæÂà∞lyricsInputÔºåËß¶ÂèëÁÇπÂáª"),U.value.click()):console.error("lyricsInput ref Êú™ÊâæÂà∞")},100)},Be=()=>{M.value&&M.value.click()},Re=async P=>{const I=P.target.files;if(!(!I||I.length===0)){$.value=!0,w.value=0,T.value=0,K.value=0,S.value="Ê≠£Âú®Êâ´ÊèèÊñá‰ª∂Â§π...";try{const L=[];if(Array.from(I).forEach(A=>{T.value++,st(A.name)&&(L.push(A),K.value++)}),L.length===0){alert("Âú®ÈÄâÊã©ÁöÑÊñá‰ª∂Â§π‰∏≠Ê≤°ÊúâÊâæÂà∞Èü≥È¢ëÊñá‰ª∂");return}S.value="Ê≠£Âú®Â§ÑÁêÜÈü≥È¢ëÊñá‰ª∂...",await Ee(L),S.value=`ÊâπÈáèÂØºÂÖ•ÂÆåÊàêÔºÅÂÖ±Â§ÑÁêÜ ${L.length} ‰∏™Èü≥È¢ëÊñá‰ª∂`,setTimeout(()=>{$.value=!1},2e3)}catch(L){console.error("Â§ÑÁêÜÊñá‰ª∂Â§πÂ§±Ë¥•:",L),setError("Â§ÑÁêÜÊñá‰ª∂Â§πÂ§±Ë¥•: "+L.message)}finally{P.target.value="",$.value&&setTimeout(()=>{$.value=!1},1e3)}}},st=P=>{const I=[".mp3",".wav",".flac",".m4a",".aac",".ogg",".wma",".mp4"],L=P.toLowerCase().substring(P.lastIndexOf("."));return I.includes(L)},Ee=async P=>{const I=P.length;for(let L=0;L<I;L++){const A=P[L];S.value=`Ê≠£Âú®Â§ÑÁêÜ: ${A.name} (${L+1}/${I})`,w.value=50+(L+1)/I*50;try{const R=await kt(A),J={id:ne(),file:A,name:A.name,type:"audio",size:Fe(A.size),url:Ct(A),title:R.title||A.name.replace(/\.[^/.]+$/,""),artist:R.artist||"Êú™Áü•Ëâ∫ÊúØÂÆ∂",album:R.album||"",duration:R.duration||0,cover:null,lrcFile:null,webkitRelativePath:A.webkitRelativePath||A.name};u.value.push(J)}catch(R){console.warn("Â§ÑÁêÜÈü≥È¢ëÊñá‰ª∂Â§±Ë¥•:",A.name,R)}L%5===0&&await new Promise(R=>setTimeout(R,10))}};return(P,I)=>(d(),g("div",hl,[I[10]||(I[10]=e("div",{class:"upload-header"},[e("h2",null,"Ê∑ªÂä†Èü≥‰πê"),e("p",null,"ÊãñÊãΩÈü≥‰πêÊñá‰ª∂„ÄÅÂ∞ÅÈù¢ÂõæÁâáÂíåÊ≠åËØçÊñá‰ª∂Âà∞‰∏ãÊñπÂå∫ÂüüÔºåÊàñÁÇπÂáªÈÄâÊã©Êñá‰ª∂")],-1)),e("div",{class:G(["drop-zone",{"drag-over":s.value,uploading:r.value}]),onDrop:B,onDragover:p,onDragenter:x,onDragleave:D,onClick:W},[e("div",{class:"drop-zone-content"},[I[1]||(I[1]=e("div",{class:"upload-icon"},"üìÅ",-1)),I[2]||(I[2]=e("div",{class:"upload-text"},[e("h3",null,"ÊãñÊãΩÊñá‰ª∂Âà∞ËøôÈáå"),e("p",null,"ÊîØÊåÅ MP3„ÄÅMP4„ÄÅWAV„ÄÅFLAC Á≠âÈü≥È¢ëÊ†ºÂºè"),e("p",null,"ÊîØÊåÅ JPG„ÄÅPNG„ÄÅWEBP Á≠âÂõæÁâáÊ†ºÂºè"),e("p",null,"ÊîØÊåÅ LRC„ÄÅTXT Á≠âÊ≠åËØçÊ†ºÂºè")],-1)),e("div",{class:"upload-buttons"},[I[0]||(I[0]=e("button",{class:"upload-button",type:"button"}," ÈÄâÊã©Êñá‰ª∂ ",-1)),e("button",{class:"batch-import-button",type:"button",onClick:Be}," üìÅ ÊâπÈáèÂØºÂÖ•Êñá‰ª∂Â§π ")])]),r.value?(d(),g("div",ml,[e("div",fl,[e("div",{class:"progress-fill",style:ze({width:`${i.value}%`})},null,4)]),e("p",null,"Ê≠£Âú®Â§ÑÁêÜÊñá‰ª∂... "+k(i.value)+"%",1)])):q("",!0),$.value?(d(),g("div",bl,[e("div",wl,[e("div",{class:"progress-fill",style:ze({width:`${w.value}%`})},null,4)]),e("p",null,k(S.value),1),e("div",kl,[e("span",null,"Â∑≤Êâ´Êèè: "+k(T.value)+" ‰∏™Êñá‰ª∂",1),e("span",null,"ÊâæÂà∞Èü≥È¢ë: "+k(K.value)+" ‰∏™",1)])])):q("",!0)],34),e("input",{ref_key:"fileInput",ref:f,type:"file",multiple:"",accept:"audio/*,image/*,.lrc,.txt",style:{display:"none"},onChange:z},null,544),e("input",{ref_key:"coverInput",ref:F,type:"file",accept:"image/*",style:{display:"none"},onChange:ve},null,544),e("input",{ref_key:"lyricsInput",ref:U,type:"file",accept:".lrc,.LRC,.txt,.TXT",style:{display:"none"},onChange:je},null,544),e("input",{ref_key:"folderInput",ref:M,type:"file",webkitdirectory:"",multiple:"",style:{display:"none"},onChange:Re},null,544),u.value.length>0?(d(),g("div",$l,[I[9]||(I[9]=e("h3",null,"ÂæÖÊ∑ªÂä†ÁöÑÊñá‰ª∂",-1)),e("div",Cl,[(d(!0),g(ce,null,de(u.value,(L,A)=>(d(),g("div",{key:A,class:G(["file-item",{"audio-file":L.type==="audio"}])},[e("div",Sl,[e("div",Il,k(L.type==="audio"?"üéµ":L.type==="lyrics"?"üìù":"üñºÔ∏è"),1),e("div",Ml,[L.type==="audio"?(d(),g("div",xl,[e("div",_l,[I[3]||(I[3]=e("label",null,"Ê≠åÊõ≤ÂêçÁß∞:",-1)),te(e("input",{"onUpdate:modelValue":R=>L.title=R,type:"text",placeholder:"ËØ∑ËæìÂÖ•Ê≠åÊõ≤ÂêçÁß∞",class:"song-input"},null,8,Pl),[[Ne,L.title]])]),e("div",Ll,[I[4]||(I[4]=e("label",null,"Ê≠åÊâã:",-1)),te(e("input",{"onUpdate:modelValue":R=>L.artist=R,type:"text",placeholder:"ËØ∑ËæìÂÖ•Ê≠åÊâãÂêçÁß∞",class:"song-input"},null,8,Dl),[[Ne,L.artist]])]),e("div",Al,[I[6]||(I[6]=e("label",null,"Â∞ÅÈù¢:",-1)),te(e("select",{"onUpdate:modelValue":R=>L.selectedCover=R,class:"cover-select"},[I[5]||(I[5]=e("option",{value:""},"ÈÄâÊã©Â∞ÅÈù¢ÂõæÁâá",-1)),(d(!0),g(ce,null,de(O.value,(R,J)=>(d(),g("option",{key:J,value:R.id},k(R.name),9,Tl))),128))],8,Ul),[[bt,L.selectedCover]]),e("button",{type:"button",class:"upload-cover-btn",onClick:R=>Se(A)}," ‰∏ä‰º†Â∞ÅÈù¢ ",8,Fl)]),e("div",zl,[I[8]||(I[8]=e("label",null,"Ê≠åËØç:",-1)),te(e("select",{"onUpdate:modelValue":R=>L.selectedLyrics=R,class:"lyrics-select"},[I[7]||(I[7]=e("option",{value:""},"ÈÄâÊã©Ê≠åËØçÊñá‰ª∂ÔºàÂèØÈÄâÔºâ",-1)),(d(!0),g(ce,null,de(N.value,(R,J)=>(d(),g("option",{key:J,value:R.id},k(R.name),9,jl))),128))],8,Nl),[[bt,L.selectedLyrics]]),e("button",{type:"button",class:"upload-lyrics-btn",onClick:R=>Ie(A)}," ‰∏ä‰º†Ê≠åËØç ",8,Bl)]),e("p",Rl,k(L.duration||"")+" | "+k(L.fileSize),1)])):L.type==="image"?(d(),g("div",El,[e("h4",null,k(L.name),1),e("p",Ol,k(He(Fe)(L.file.size)),1)])):L.type==="lyrics"?(d(),g("div",ql,[e("h4",null,k(L.name),1),e("p",Vl,"Ê≠åËØçÊñá‰ª∂ | "+k(He(Fe)(L.file.size)),1),L.preview?(d(),g("p",Hl,k(L.preview),1)):q("",!0)])):q("",!0)])]),e("button",{class:"remove-button",onClick:R=>Le(A)}," ‚úï ",8,Gl)],2))),128))]),e("div",Wl,[e("button",{class:"confirm-button",onClick:Je,disabled:r.value}," Ê∑ªÂä†Âà∞Êí≠ÊîæÂàóË°® ",8,Zl),e("button",{class:"cancel-button",onClick:Me,disabled:r.value}," Ê∏ÖÁ©∫ ",8,Yl),e("button",{class:"test-lyrics-button",onClick:Ye,disabled:r.value}," ÊµãËØïÊ≠åËØç‰∏ä‰º† ",8,Kl)])])):q("",!0),o.value?(d(),g("div",Ql,[e("p",null,k(o.value),1),e("button",{onClick:ie},"ÂÖ≥Èó≠")])):q("",!0)]))}},Xl=ue(Jl,[["__scopeId","data-v-74caa0b8"]]),eo={class:"modal-body"},to={__name:"AddMusicModal",emits:["close","files-uploaded"],setup(a,{emit:c}){const n=c,s=()=>{n("close")},r=i=>{n("files-uploaded",i),s()};return(i,o)=>(d(),g("div",{class:"modal-overlay",onClick:s},[e("div",{class:"modal-content",onClick:o[0]||(o[0]=se(()=>{},["stop"]))},[e("div",{class:"modal-header"},[o[2]||(o[2]=e("h2",null,"Ê∑ªÂä†Èü≥‰πê",-1)),e("button",{class:"close-button",onClick:s},o[1]||(o[1]=[e("span",null,"‚úï",-1)]))]),e("div",eo,[Te(Xl,{onFilesUploaded:r})])])]))}},so=ue(to,[["__scopeId","data-v-5428a192"]]),lo={class:"modal-body"},oo={class:"form-group"},ao={class:"form-group"},no={class:"form-group"},io={class:"cover-selection"},ro={class:"cover-preview"},co=["src"],uo={class:"form-group"},vo={class:"lyrics-selection"},go={key:0,class:"lyrics-preview"},po={class:"lyrics-info"},yo={class:"lyrics-filename"},ho={key:1,class:"lyrics-empty"},mo={class:"lyrics-options"},fo={__name:"EditSongModal",props:{song:{type:Object,default:null},getCoverUrl:{type:Function,required:!0},resourceManager:{type:Object,required:!0}},emits:["close","save"],setup(a,{emit:c}){const n=a,s=c,r=b({title:"",artist:"",cover:null,lrcFile:null}),i=b(null),o=b(null),u=b(""),f=b(""),F=b("");Ge(()=>n.song,N=>{try{N&&(r.value={title:N.title||"",artist:N.artist||"",cover:N.cover||null,lrcFile:N.lrcFile||null},f.value=N.cover||null,F.value=N.lrcFile||null,u.value=n.getCoverUrl(N.cover))}catch(p){console.error("Êõ¥Êñ∞Ê≠åÊõ≤Êï∞ÊçÆÂ§±Ë¥•:",p),r.value={title:"",artist:"",cover:null,lrcFile:null},f.value=null,F.value=null,u.value=""}},{immediate:!0});const U=()=>{s("close")},M=()=>{i.value?.click()},h=N=>{const p=N.target.files[0];if(p){if(p.size>5*1024*1024){alert("ÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá5MB");return}const x=new FileReader;x.onload=D=>{const B=D.target.result;r.value.cover=B,u.value=B},x.readAsDataURL(p)}},$=()=>{r.value.cover=f.value,u.value=n.getCoverUrl(f.value)},w=()=>{o.value?.click()},S=async N=>{const p=N.target.files[0];if(p){if(p.size>1*1024*1024){alert("Ê≠åËØçÊñá‰ª∂Â§ßÂ∞è‰∏çËÉΩË∂ÖËøá1MB");return}try{const D=`lyrics_${Date.now().toString(36)+Math.random().toString(36).substr(2)}.lrc`,B=n.resourceManager;B&&(await B.saveFile(p,"lyrics",D),r.value.lrcFile=D)}catch(x){console.error("‰øùÂ≠òÊ≠åËØçÊñá‰ª∂Â§±Ë¥•:",x),alert("‰øùÂ≠òÊ≠åËØçÊñá‰ª∂Â§±Ë¥•ÔºåËØ∑ÈáçËØï")}}},T=()=>{r.value.lrcFile=null},K=()=>{r.value.lrcFile=F.value},O=()=>{if(!r.value.title.trim()||!r.value.artist.trim()){alert("ËØ∑Â°´ÂÜôÂÆåÊï¥ÁöÑÊ≠åÊõ≤‰ø°ÊÅØ");return}s("save",{...n.song,title:r.value.title.trim(),artist:r.value.artist.trim(),cover:r.value.cover,lrcFile:r.value.lrcFile}),U()};return(N,p)=>(d(),g("div",{class:"modal-overlay",onClick:U},[e("div",{class:"modal-content",onClick:p[2]||(p[2]=se(()=>{},["stop"]))},[e("div",{class:"modal-header"},[p[4]||(p[4]=e("h2",null,"ÁºñËæëÊ≠åÊõ≤‰ø°ÊÅØ",-1)),e("button",{class:"close-btn",onClick:U},p[3]||(p[3]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))]),e("div",lo,[e("form",{onSubmit:se(O,["prevent"])},[e("div",oo,[p[5]||(p[5]=e("label",{for:"title"},"Ê≠åÊõ≤Ê†áÈ¢ò",-1)),te(e("input",{id:"title","onUpdate:modelValue":p[0]||(p[0]=x=>r.value.title=x),type:"text",class:"form-input",placeholder:"ËØ∑ËæìÂÖ•Ê≠åÊõ≤Ê†áÈ¢ò",required:""},null,512),[[Ne,r.value.title]])]),e("div",ao,[p[6]||(p[6]=e("label",{for:"artist"},"Ëâ∫ÊúØÂÆ∂",-1)),te(e("input",{id:"artist","onUpdate:modelValue":p[1]||(p[1]=x=>r.value.artist=x),type:"text",class:"form-input",placeholder:"ËØ∑ËæìÂÖ•Ëâ∫ÊúØÂÆ∂ÂêçÁß∞",required:""},null,512),[[Ne,r.value.artist]])]),e("div",no,[p[9]||(p[9]=e("label",null,"Ê≠åÊõ≤Â∞ÅÈù¢",-1)),e("div",io,[e("div",ro,[e("img",{src:u.value,alt:"Â∞ÅÈù¢È¢ÑËßà"},null,8,co),e("div",{class:"cover-overlay"},[e("button",{type:"button",onClick:M,class:"change-cover-btn"}," Êõ¥Êç¢Â∞ÅÈù¢ ")])]),e("input",{ref_key:"fileInput",ref:i,type:"file",accept:"image/*",onChange:h,style:{display:"none"}},null,544),e("div",{class:"cover-options"},[e("button",{type:"button",onClick:M,class:"upload-btn"},p[7]||(p[7]=[e("span",null,"üìÅ",-1),H(" ‰∏ä‰º†ÂõæÁâá ")])),e("button",{type:"button",onClick:$,class:"default-btn"},p[8]||(p[8]=[e("span",null,"üîÑ",-1),H(" ÊÅ¢Â§çÂéüÂ∞ÅÈù¢ ")]))])])]),e("div",uo,[p[15]||(p[15]=e("label",null,"Ê≠åËØçÊñá‰ª∂",-1)),e("div",vo,[r.value.lrcFile?(d(),g("div",go,[e("div",po,[e("span",yo,k(r.value.lrcFile),1),p[10]||(p[10]=e("span",{class:"lyrics-status"},"Â∑≤ÊúâÊ≠åËØçÊñá‰ª∂",-1))])])):(d(),g("div",ho,p[11]||(p[11]=[e("div",{class:"empty-icon"},"üìù",-1),e("p",null,"ÊöÇÊó†Ê≠åËØçÊñá‰ª∂",-1)]))),e("input",{ref_key:"lyricsInput",ref:o,type:"file",accept:".lrc,.LRC,.txt,.TXT",onChange:S,style:{display:"none"}},null,544),e("div",mo,[e("button",{type:"button",onClick:w,class:"upload-btn lyrics-btn"},[p[12]||(p[12]=e("span",null,"üìù",-1)),H(" "+k(r.value.lrcFile?"Êõ¥Êç¢Ê≠åËØç":"‰∏ä‰º†Ê≠åËØç"),1)]),r.value.lrcFile?(d(),g("button",{key:0,type:"button",onClick:T,class:"remove-btn"},p[13]||(p[13]=[e("span",null,"üóëÔ∏è",-1),H(" Âà†Èô§Ê≠åËØç ")]))):q("",!0),F.value&&F.value!==r.value.lrcFile?(d(),g("button",{key:1,type:"button",onClick:K,class:"default-btn"},p[14]||(p[14]=[e("span",null,"üîÑ",-1),H(" ÊÅ¢Â§çÂéüÊ≠åËØç ")]))):q("",!0)])])]),e("div",{class:"form-actions"},[e("button",{type:"button",class:"btn-cancel",onClick:U}," ÂèñÊ∂à "),p[16]||(p[16]=e("button",{type:"submit",class:"btn-save"}," ‰øùÂ≠ò ",-1))])],32)])])]))}},bo=ue(fo,[["__scopeId","data-v-2d27c320"]]),wo={class:"search-input-container"},ko={class:"search-results"},$o={key:0,class:"search-tips"},Co={key:1,class:"no-results"},So={key:2,class:"results-list"},Io={class:"results-header"},Mo={class:"song-list"},xo=["onClick"],_o={class:"song-cover"},Po=["src"],Lo={class:"song-info"},Do=["innerHTML"],Ao=["innerHTML"],Uo={class:"song-actions"},To=["onClick","title"],Fo={__name:"SearchModal",props:{searchQuery:String,searchResults:Array,currentSong:Object,isPlaying:Boolean,getCoverUrl:Function},emits:["close","search","clear-search","play-song","toggle-favorite"],setup(a,{emit:c}){const n=a,s=c,r=b(null),i=b(n.searchQuery||""),o=()=>{s("search",i.value)},u=()=>{i.value="",s("clear-search")},f=()=>{s("close")},F=h=>{s("play-song",h),f()},U=h=>{s("toggle-favorite",h)},M=(h,$)=>{if(!$)return h;const w=new RegExp(`(${$})`,"gi");return h.replace(w,"<mark>$1</mark>")};return We(()=>{vt(()=>{r.value&&r.value.focus()})}),(h,$)=>(d(),g("div",{class:"search-modal-overlay",onClick:f},[e("div",{class:"search-modal",onClick:$[1]||($[1]=se(()=>{},["stop"]))},[e("div",{class:"search-header"},[$[3]||($[3]=e("h2",null,"ÊêúÁ¥¢Èü≥‰πê",-1)),e("button",{class:"close-btn",onClick:f},$[2]||($[2]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))]),e("div",wo,[te(e("input",{ref_key:"searchInput",ref:r,type:"text","onUpdate:modelValue":$[0]||($[0]=w=>i.value=w),onInput:o,placeholder:"ÊêúÁ¥¢Ê≠åÊõ≤„ÄÅËâ∫ÊúØÂÆ∂Êàñ‰∏ìËæë...",class:"search-input"},null,544),[[Ne,i.value]]),i.value?(d(),g("button",{key:0,class:"clear-btn",onClick:u},$[4]||($[4]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))):q("",!0)]),e("div",ko,[i.value?a.searchResults.length===0?(d(),g("div",Co,$[6]||($[6]=[e("div",{class:"no-results-icon"},"üòî",-1),e("h3",null,"Ê≤°ÊúâÊâæÂà∞ÁªìÊûú",-1),e("p",null,"Â∞ùËØï‰ΩøÁî®‰∏çÂêåÁöÑÂÖ≥ÈîÆËØçÊêúÁ¥¢",-1)]))):(d(),g("div",So,[e("div",Io,[e("h3",null,"ÊêúÁ¥¢ÁªìÊûú ("+k(a.searchResults.length)+")",1)]),e("div",Mo,[(d(!0),g(ce,null,de(a.searchResults,w=>(d(),g("div",{key:w.id,class:G(["song-item",{playing:a.currentSong?.id===w.id&&a.isPlaying,current:a.currentSong?.id===w.id}]),onClick:S=>F(w)},[e("div",_o,[e("img",{src:a.getCoverUrl(w.cover),alt:"Â∞ÅÈù¢"},null,8,Po),$[7]||($[7]=e("div",{class:"play-overlay"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M8 5v14l11-7z"})])],-1))]),e("div",Lo,[e("div",{class:"song-title",innerHTML:M(w.title,i.value)},null,8,Do),e("div",{class:"song-artist",innerHTML:M(w.artist,i.value)},null,8,Ao)]),e("div",Uo,[e("button",{class:"action-btn",onClick:se(S=>U(w),["stop"]),title:w.isFavorite?"ÂèñÊ∂àÊî∂Ëóè":"Êî∂Ëóè"},[e("span",{class:G(["heart-icon",{filled:w.isFavorite}])},k(w.isFavorite?"‚ô•":"‚ô°"),3)],8,To)])],10,xo))),128))])])):(d(),g("div",$o,$[5]||($[5]=[e("div",{class:"tips-icon"},"üîç",-1),e("h3",null,"ÂºÄÂßãÊêúÁ¥¢",-1),e("p",null,"ËæìÂÖ•Ê≠åÊõ≤Âêç„ÄÅËâ∫ÊúØÂÆ∂Êàñ‰∏ìËæëÂêçÊù•ÊêúÁ¥¢Èü≥‰πê",-1),e("div",{class:"search-shortcuts"},[e("div",{class:"shortcut"},[e("kbd",null,"Ctrl"),H(" + "),e("kbd",null,"F"),H(" ÊâìÂºÄÊêúÁ¥¢ ")]),e("div",{class:"shortcut"},[e("kbd",null,"ESC"),H(" ÂÖ≥Èó≠ÊêúÁ¥¢ ")])],-1)])))])])]))}},zo=ue(Fo,[["__scopeId","data-v-eb6874a6"]]),No={__name:"KeyboardShortcuts",emits:["close"],setup(a,{emit:c}){const n=c,s=()=>{n("close")};return(r,i)=>(d(),g("div",{class:"shortcuts-overlay",onClick:s},[e("div",{class:"shortcuts-modal",onClick:i[0]||(i[0]=se(()=>{},["stop"]))},[e("div",{class:"shortcuts-header"},[i[2]||(i[2]=e("h2",null,"ÈîÆÁõòÂø´Êç∑ÈîÆ",-1)),e("button",{class:"close-btn",onClick:s},i[1]||(i[1]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))]),i[3]||(i[3]=Mt('<div class="shortcuts-content" data-v-a4d1dfe3><div class="shortcuts-section" data-v-a4d1dfe3><h3 data-v-a4d1dfe3>Êí≠ÊîæÊéßÂà∂</h3><div class="shortcut-list" data-v-a4d1dfe3><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>Á©∫Ê†º</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>Êí≠Êîæ/ÊöÇÂÅú</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>K</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>Êí≠Êîæ/ÊöÇÂÅú</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>J</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÂêéÈÄÄ 10 Áßí</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>L</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÂâçËøõ 10 Áßí</div></div></div></div><div class="shortcuts-section" data-v-a4d1dfe3><h3 data-v-a4d1dfe3>Èü≥ÈáèÊéßÂà∂</h3><div class="shortcut-list" data-v-a4d1dfe3><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>‚Üë</kbd> / <kbd data-v-a4d1dfe3>‚Üì</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>Ë∞ÉËäÇÈü≥Èáè</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>‚Üê</kbd> / <kbd data-v-a4d1dfe3>‚Üí</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>Ë∞ÉËäÇÈü≥Èáè</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>M</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÈùôÈü≥/ÂèñÊ∂àÈùôÈü≥</div></div></div></div><div class="shortcuts-section" data-v-a4d1dfe3><h3 data-v-a4d1dfe3>ËøõÂ∫¶ÊéßÂà∂</h3><div class="shortcut-list" data-v-a4d1dfe3><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>Shift</kbd> + <kbd data-v-a4d1dfe3>‚Üê</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÂêéÈÄÄ 10 Áßí</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>Shift</kbd> + <kbd data-v-a4d1dfe3>‚Üí</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÂâçËøõ 10 Áßí</div></div></div></div><div class="shortcuts-section" data-v-a4d1dfe3><h3 data-v-a4d1dfe3>Êí≠ÊîæÈÄüÂ∫¶</h3><div class="shortcut-list" data-v-a4d1dfe3><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>Shift</kbd> + <kbd data-v-a4d1dfe3>,</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÂáèÊÖ¢Êí≠ÊîæÈÄüÂ∫¶</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>Shift</kbd> + <kbd data-v-a4d1dfe3>.</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>Âä†Âø´Êí≠ÊîæÈÄüÂ∫¶</div></div></div></div><div class="shortcuts-section" data-v-a4d1dfe3><h3 data-v-a4d1dfe3>ÂÖ∂‰ªñÂäüËÉΩ</h3><div class="shortcut-list" data-v-a4d1dfe3><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>Ctrl</kbd> + <kbd data-v-a4d1dfe3>F</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÊêúÁ¥¢Èü≥‰πê</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>ESC</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÂÖ≥Èó≠ÊêúÁ¥¢/Ê®°ÊÄÅÊ°Ü</div></div><div class="shortcut-item" data-v-a4d1dfe3><div class="shortcut-keys" data-v-a4d1dfe3><kbd data-v-a4d1dfe3>?</kbd></div><div class="shortcut-desc" data-v-a4d1dfe3>ÊòæÁ§∫Âø´Êç∑ÈîÆÂ∏ÆÂä©</div></div></div></div></div>',1))])]))}},jo=ue(No,[["__scopeId","data-v-a4d1dfe3"]]);class Bo{constructor(c=null){this.baseUrl=c||"http://localhost:3000",this.requestQueue=[],this.isProcessing=!1,this.requestDelay=300}async makeRequest(c,n={}){return new Promise((s,r)=>{this.requestQueue.push({url:c,options:n,resolve:s,reject:r}),this.processQueue()})}async processQueue(){if(!(this.isProcessing||this.requestQueue.length===0)){for(this.isProcessing=!0;this.requestQueue.length>0;){const{url:c,options:n,resolve:s,reject:r}=this.requestQueue.shift();try{const i=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json",...n.headers},...n});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.json();s(o)}catch(i){console.error("APIËØ∑Ê±ÇÂ§±Ë¥•:",i),r(i)}this.requestQueue.length>0&&await new Promise(i=>setTimeout(i,this.requestDelay))}this.isProcessing=!1}}async searchSongs(c,n=20,s=0){try{const r=`${this.baseUrl}/Search?keywords=${encodeURIComponent(c)}&limit=${n}`,i=await this.makeRequest(r);return console.log("ÊêúÁ¥¢APIÂìçÂ∫î:",i),i.status===200&&i.result?{success:!0,songs:i.result.map(o=>({id:o.id,name:o.name||"Êú™Áü•Ê≠åÊõ≤",artist:o.artists&&Array.isArray(o.artists)?o.artists.map(u=>u.name).join(", "):"Êú™Áü•Ëâ∫ÊúØÂÆ∂",artists:o.artists||[],album:o.album&&o.album.name?o.album.name:"Êú™Áü•‰∏ìËæë",albumId:o.album&&o.album.id?o.album.id:null,duration:o.duration||0,cover:o.album&&o.album.picUrl?o.album.picUrl:"",source:"netease"})),total:i.result.length||0}:{success:!1,songs:[],total:0,error:"ÊêúÁ¥¢ÁªìÊûú‰∏∫Á©∫"}}catch(r){return console.error("ÊêúÁ¥¢Ê≠åÊõ≤Â§±Ë¥•:",r),{success:!1,songs:[],total:0,error:r.message}}}async getSongUrl(c,n="exhigh"){try{const s=`${this.baseUrl}/Song_V1?ids=${c}&level=${n}&type=json`,r=await this.makeRequest(s);return console.log(`Ëé∑ÂèñÊ≠åÊõ≤${c}Êí≠ÊîæÈìæÊé•ÂìçÂ∫î:`,r),r.status===200&&r.url?{success:!0,url:r.url,br:r.level,size:r.size,type:"mp3"}:{success:!1,error:"Êó†Ê≥ïËé∑ÂèñÊí≠ÊîæÈìæÊé•"}}catch(s){return console.error("Ëé∑ÂèñÊí≠ÊîæÈìæÊé•Â§±Ë¥•:",s),{success:!1,error:s.message}}}async getLyrics(c){try{const n=`${this.baseUrl}/lyric?id=${c}`,s=await this.makeRequest(n);return s.status===200?{success:!0,lyric:s.lyric||"",tlyric:s.tlyric||"",romalrc:""}:{success:!1,lyric:"",error:"Êó†Ê≥ïËé∑ÂèñÊ≠åËØç"}}catch(n){return console.error("Ëé∑ÂèñÊ≠åËØçÂ§±Ë¥•:",n),{success:!1,lyric:"",error:n.message}}}async getSongDetail(c){try{const n=Array.isArray(c)?c.join(","):c,s=`${this.baseUrl}/song/detail?ids=${n}`,r=await this.makeRequest(s);return r.code===200&&r.songs?{success:!0,songs:r.songs.map(i=>({id:i.id,name:i.name,artist:i.ar.map(o=>o.name).join(", "),artists:i.ar,album:i.al.name,albumId:i.al.id,duration:i.dt,cover:i.al.picUrl,publishTime:i.publishTime,source:"netease"}))}:{success:!1,songs:[],error:"Ëé∑ÂèñÊ≠åÊõ≤ËØ¶ÊÉÖÂ§±Ë¥•"}}catch(n){return console.error("Ëé∑ÂèñÊ≠åÊõ≤ËØ¶ÊÉÖÂ§±Ë¥•:",n),{success:!1,songs:[],error:n.message}}}async getHotSearch(){try{const c=`${this.baseUrl}/search/hot`,n=await this.makeRequest(c);return n.code===200&&n.result?.hots?{success:!0,keywords:n.result.hots.map(s=>s.first)}:{success:!1,keywords:[],error:"Ëé∑ÂèñÁÉ≠Èó®ÊêúÁ¥¢Â§±Ë¥•"}}catch(c){return console.error("Ëé∑ÂèñÁÉ≠Èó®ÊêúÁ¥¢Â§±Ë¥•:",c),{success:!1,keywords:[],error:c.message}}}async getSearchSuggest(c){try{const n=`${this.baseUrl}/search/suggest?keywords=${encodeURIComponent(c)}&type=mobile`,s=await this.makeRequest(n);if(s.code===200&&s.result){const r=[];return s.result.songs&&r.push(...s.result.songs.map(i=>({type:"song",name:i.name,artist:i.artists.map(o=>o.name).join(", "),id:i.id}))),s.result.artists&&r.push(...s.result.artists.map(i=>({type:"artist",name:i.name,id:i.id}))),{success:!0,suggestions:r}}return{success:!1,suggestions:[],error:"Ëé∑ÂèñÊêúÁ¥¢Âª∫ËÆÆÂ§±Ë¥•"}}catch(n){return console.error("Ëé∑ÂèñÊêúÁ¥¢Âª∫ËÆÆÂ§±Ë¥•:",n),{success:!1,suggestions:[],error:n.message}}}async checkStatus(){try{const c=`${this.baseUrl}/`;return(await fetch(c,{method:"GET",timeout:5e3})).ok}catch(c){return console.error("APIÊúçÂä°‰∏çÂèØÁî®:",c),!1}}async checkStatus(){try{const c=`${this.baseUrl}/`,n=await this.makeRequest(c);return n.message&&n.message.includes("Node.jsÁâàÁΩëÊòì‰∫ëÈü≥‰πêAPI")}catch(c){return console.error("Ê£ÄÊü•APIÁä∂ÊÄÅÂ§±Ë¥•:",c),!1}}async getHotSearch(){try{return{success:!0,keywords:["Âë®Êù∞‰º¶","ÈÇìÁ¥´Ê£ã","Ëñõ‰πãË∞¶","Êûó‰øäÊù∞","ÈôàÂ•ïËøÖ","Âº†Â≠¶Âèã","ÁéãËè≤","ÊùéËç£Êµ©","ÊØõ‰∏çÊòì","ÂçéÊô®ÂÆá"]}}catch(c){return console.error("Ëé∑ÂèñÁÉ≠Èó®ÊêúÁ¥¢Â§±Ë¥•:",c),{success:!1,keywords:[]}}}async getSearchSuggest(c){try{const n=await this.searchSongs(c,5);return n.success?{success:!0,suggestions:n.songs.map(r=>({id:r.id,name:r.name,artist:r.artist,type:"song"}))}:{success:!1,suggestions:[]}}catch(n){return console.error("Ëé∑ÂèñÊêúÁ¥¢Âª∫ËÆÆÂ§±Ë¥•:",n),{success:!1,suggestions:[]}}}async getSongDetail(c){try{const n=Array.isArray(c)?c.join(","):c.toString(),s=`${this.baseUrl}/song/detail?ids=${n}`,r=await this.makeRequest(s);if(console.log("Ê≠åÊõ≤ËØ¶ÊÉÖAPIÂìçÂ∫î:",r),r.code===200&&r.songs&&r.songs.length>0){const i=r.songs[0];return{success:!0,song:{id:i.id,name:i.name,artists:i.ar||[],album:i.al||{},duration:i.dt,cover:i.al?.picUrl?i.al.picUrl.replace(/\?param=\d+y\d+/,"?param=500y500"):null,albumId:i.al?.id,albumName:i.al?.name,publishTime:i.publishTime,popularity:i.pop}}}return{success:!1,error:"Ëé∑ÂèñÊ≠åÊõ≤ËØ¶ÊÉÖÂ§±Ë¥•"}}catch(n){return console.error("Ëé∑ÂèñÊ≠åÊõ≤ËØ¶ÊÉÖÂ§±Ë¥•:",n),{success:!1,error:n.message}}}async getAlbumInfo(c){try{const n=`${this.baseUrl}/album?id=${c}`,s=await this.makeRequest(n);return s.code===200&&s.album?{success:!0,album:{id:s.album.id,name:s.album.name,cover:s.album.picUrl?s.album.picUrl.replace(/\?param=\d+y\d+/,"?param=500y500"):null,artist:s.album.artist?.name||"",publishTime:s.album.publishTime,description:s.album.description}}:{success:!1,error:"Ëé∑Âèñ‰∏ìËæë‰ø°ÊÅØÂ§±Ë¥•"}}catch(n){return console.error("Ëé∑Âèñ‰∏ìËæë‰ø°ÊÅØÂ§±Ë¥•:",n),{success:!1,error:n.message}}}setBaseUrl(c){this.baseUrl=c}}const Pe=new Bo,Ro={class:"netease-online-container"},Eo={class:"online-header"},Oo={class:"status-container"},qo={class:"status-text"},Vo={key:0},Ho={key:0,class:"vip-badge super"},Go={key:1,class:"vip-badge black"},Wo={key:2,class:"vip-badge normal"},Zo={key:3,class:"vip-badge free"},Yo={key:1,class:"guest"},Ko={class:"search-section"},Qo={class:"search-input-container"},Jo=["disabled"],Xo=["disabled"],ea={key:0,class:"loading-spinner small"},ta={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},sa={key:0,class:"search-suggestions"},la=["onClick"],oa={class:"suggestion-type"},aa={class:"suggestion-text"},na={key:0,class:"suggestion-artist"},ia={key:1,class:"hot-search"},ra={class:"hot-keywords"},ca=["onClick"],da={key:0,class:"search-results"},ua={class:"results-header"},va={class:"results-actions"},ga=["disabled"],pa={key:0,class:"loading-spinner small"},ya={class:"song-list"},ha=["onClick"],ma={class:"song-checkbox"},fa=["checked","onChange"],ba={class:"song-cover"},wa=["src","alt"],ka={class:"song-info"},$a={class:"song-name"},Ca={class:"song-details"},Sa={class:"song-artist"},Ia={class:"song-album"},Ma={class:"song-duration"},xa={class:"song-actions"},_a=["onClick","disabled"],Pa={key:1,class:"download-progress"},La={class:"progress-info"},Da={class:"progress-bar"},Aa={class:"login-content"},Ua={class:"login-step"},Ta={class:"login-options"},Fa={class:"option-card"},za=["disabled"],Na={key:0,class:"qr-login-step"},ja={class:"qr-container"},Ba={key:0,class:"qr-display"},Ra=["src"],Ea={key:0,class:"qr-fallback"},Oa={class:"qr-link"},qa=["value"],Va={key:1,class:"qr-placeholder"},Ha={class:"login-instructions"},Ga={key:0,class:"captcha-section"},Wa={class:"captcha-actions"},Za={key:0,class:"cookie-help-section"},Ya={class:"manual-cookie-section"},Ka={class:"cookie-input-section"},Qa=["disabled"],Ja={__name:"NeteaseMusicOnlineSearch",emits:["songs-imported"],setup(a,{emit:c}){const n=c,s="data:image/svg+xml;base64,"+btoa(`
<svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect width="64" height="64" rx="8" fill="#374151"/>
  <circle cx="32" cy="32" r="20" fill="#6B7280"/>
  <circle cx="32" cy="32" r="12" fill="#374151"/>
  <circle cx="32" cy="32" r="4" fill="#9CA3AF"/>
  <path d="M28 24L36 32L28 40V24Z" fill="#9CA3AF"/>
</svg>
`),r=m=>{const v=m.target.src;if(console.warn("Â∞ÅÈù¢ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•:",v),v.includes("music.126.net")&&!m.target.dataset.retried){if(m.target.dataset.retried="true",v.includes("p1.music.126.net")){m.target.src=v.replace("p1.music.126.net","p2.music.126.net");return}else if(v.includes("p2.music.126.net")){m.target.src=v.replace("p2.music.126.net","p3.music.126.net");return}else if(v.includes("p3.music.126.net")){m.target.src=v.replace("p3.music.126.net","p4.music.126.net");return}}v.includes("data:image")||(m.target.src=s)},i=m=>{console.log("Â∞ÅÈù¢ÂõæÁâáÂä†ËΩΩÊàêÂäü:",m.target.src)},o=b(""),u=b([]),f=b(new Set),F=b(!1),U=b(!1),M=b(""),h=b(0),$=b(!1),w=b([]),S=b(!1),T=b([]),K=b(null),O=b({isLogin:!1,vipType:0,isVip:!1,isBlackVip:!1,isSuperVip:!1,nickname:"Ê∏∏ÂÆ¢"}),N=b(!1),p=b(!1),x=b({unikey:"",qrUrl:"",qrImage:""}),D=b({type:"info",message:"Á≠âÂæÖÊâ´Á†Å..."}),B=b(!1),W=b("");let z=null;const Se=async()=>{try{$.value=await Pe.checkStatus(),$.value&&await ve()}catch(m){console.error("Ê£ÄÊü•APIÁä∂ÊÄÅÂ§±Ë¥•:",m),$.value=!1}},ve=async()=>{try{const m=await fetch("http://localhost:3000/vip-status");if(m.ok){const v=await m.json();v.success&&(O.value=v.data,console.log("üéµ Áî®Êà∑Áä∂ÊÄÅ:",O.value))}}catch(m){console.warn("‚ö†Ô∏è VIPÁä∂ÊÄÅÊ£ÄÊü•Â§±Ë¥•:",m.message)}},Ie=async()=>{try{p.value=!0,z&&(clearInterval(z),z=null);const v=await(await fetch("http://localhost:3000/qr-login/generate")).json();if(v.success){x.value=v.data,B.value=!1;const _=[`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(v.data.qrUrl)}`,`https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=${encodeURIComponent(v.data.qrUrl)}`,`https://qr-server.com/api/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(v.data.qrUrl)}`];x.value.qrImage=_[0],D.value={type:"info",message:"ËØ∑‰ΩøÁî®ÁΩëÊòì‰∫ëÈü≥‰πêAPPÊâ´Êèè‰∫åÁª¥Á†Å"},je()}else D.value={type:"error",message:"ÁîüÊàê‰∫åÁª¥Á†ÅÂ§±Ë¥•ÔºåËØ∑ÈáçËØï"}}catch(m){console.error("ÁîüÊàê‰∫åÁª¥Á†ÅÂ§±Ë¥•:",m),D.value={type:"error",message:"ÁΩëÁªúÈîôËØØÔºåËØ∑Ê£ÄÊü•APIÊúçÂä°"}}finally{p.value=!1}},je=()=>{z=setInterval(async()=>{try{const v=await(await fetch("http://localhost:3000/qr-login/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({unikey:x.value.unikey})})).json();v.status==="waiting"?D.value={type:"info",message:"Á≠âÂæÖÊâ´Á†Å..."}:v.status==="scanned"?D.value={type:"warning",message:"Â∑≤Êâ´Á†ÅÔºåËØ∑Âú®ÊâãÊú∫‰∏äÁ°ÆËÆ§ÁôªÂΩï"}:v.status==="success"?(D.value={type:"success",message:"ÁôªÂΩïÊàêÂäüÔºÅÊ≠£Âú®Êõ¥Êñ∞Áä∂ÊÄÅ..."},clearInterval(z),z=null,setTimeout(async()=>{await ve(),oe()},1e3)):v.status==="expired"?(D.value={type:"error",message:"‰∫åÁª¥Á†ÅÂ∑≤ËøáÊúüÔºåËØ∑ÈáçÊñ∞ÁîüÊàê"},clearInterval(z),z=null):v.status==="captcha"||v.message&&v.message.includes("È™åËØÅÁ†Å")?(D.value={type:"captcha",message:"ÈúÄË¶ÅÂÆåÊàêÂÆâÂÖ®È™åËØÅÊâçËÉΩÁôªÂΩï"},clearInterval(z),z=null):(D.value={type:"error",message:v.message||"ÁôªÂΩïÂ§±Ë¥•"},clearInterval(z),z=null)}catch(m){console.error("Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅÂ§±Ë¥•:",m)}},2e3)},oe=()=>{N.value=!1,z&&(clearInterval(z),z=null),x.value={unikey:"",qrUrl:"",qrImage:""},D.value={type:"info",message:"Á≠âÂæÖÊâ´Á†Å..."},B.value=!1},Ze=()=>{console.warn("‰∫åÁª¥Á†ÅÂõæÁâáÂä†ËΩΩÂ§±Ë¥•ÔºåÂ∞ùËØïÂ§áÁî®ÊúçÂä°");const m=[`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(x.value.qrUrl)}`,`https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=${encodeURIComponent(x.value.qrUrl)}`,`https://qr.liantu.com/api.php?text=${encodeURIComponent(x.value.qrUrl)}`],v=x.value.qrImage;let _=0;for(let X=0;X<m.length;X++)if(!(v.includes("qrserver.com")&&X===0)&&!(v.includes("googleapis.com")&&X===1)&&!(v.includes("liantu.com")&&X===2)){_=X;break}_<m.length&&!v.includes(m[_])?(console.log(`Â∞ùËØïÂ§áÁî®‰∫åÁª¥Á†ÅÊúçÂä° ${_+1}`),x.value.qrImage=m[_]):(console.warn("ÊâÄÊúâ‰∫åÁª¥Á†ÅÊúçÂä°ÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊñáÊú¨ÈìæÊé•"),B.value=!0)},Le=async()=>{try{await navigator.clipboard.writeText(x.value.qrUrl),D.value={type:"success",message:"ÈìæÊé•Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅËØ∑Âú®ÊµèËßàÂô®‰∏≠ÊâìÂºÄ"},setTimeout(()=>{D.value={type:"info",message:"Á≠âÂæÖÁôªÂΩïÁ°ÆËÆ§..."}},3e3)}catch(m){console.error("Â§çÂà∂Â§±Ë¥•:",m),D.value={type:"error",message:"Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂ÈìæÊé•"}}},Me=()=>{window.open("https://music.163.com","_blank"),D.value={type:"info",message:"ËØ∑Âú®Êñ∞ÊâìÂºÄÁöÑÈ°µÈù¢‰∏≠ÁôªÂΩïÔºåÁÑ∂ÂêéÊâãÂä®ÈÖçÁΩÆCookie"}},Je=async()=>{try{const m=W.value.trim();if(!m){D.value={type:"error",message:"Cookie‰∏çËÉΩ‰∏∫Á©∫"};return}const _=await(await fetch("http://localhost:3000/update-cookie",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cookie:m})})).json();_.success?(D.value={type:"success",message:"CookieÊõ¥Êñ∞ÊàêÂäüÔºÅÊ≠£Âú®Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ..."},setTimeout(async()=>{await ve(),oe()},1e3)):D.value={type:"error",message:_.error||"CookieÊõ¥Êñ∞Â§±Ë¥•"}}catch(m){console.error("Êõ¥Êñ∞CookieÂ§±Ë¥•:",m),D.value={type:"error",message:"ÁΩëÁªúÈîôËØØÔºåËØ∑Ê£ÄÊü•APIÊúçÂä°"}}},ie=async()=>{try{if(!confirm("Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÁôªÂΩïÂêóÔºüÈÄÄÂá∫ÂêéÂ∞ÜÊó†Ê≥ï‰∏ãËΩΩVIPÊ≠åÊõ≤„ÄÇ"))return;const v=await(await fetch("http://localhost:3000/logout",{method:"POST",headers:{"Content-Type":"application/json"}})).json();v.success?(O.value={isLogin:!1,vipType:0,isVip:!1,isBlackVip:!1,isSuperVip:!1,nickname:"Ê∏∏ÂÆ¢"},W.value="",ElMessage.success("Â∑≤ÊàêÂäüÈÄÄÂá∫ÁôªÂΩï"),console.log("üö™ Â∑≤ÈÄÄÂá∫ÁôªÂΩï")):ElMessage.error(v.error||"ÈÄÄÂá∫ÁôªÂΩïÂ§±Ë¥•")}catch(m){console.error("ÈÄÄÂá∫ÁôªÂΩïÂ§±Ë¥•:",m),ElMessage.error("ÁΩëÁªúÈîôËØØÔºåËØ∑Ê£ÄÊü•APIÊúçÂä°")}},Ye=()=>{window.open("https://music.163.com/login","_blank","width=1000,height=700,scrollbars=yes,resizable=yes"),D.value={type:"info",message:'ËØ∑Âú®Êñ∞Á™óÂè£‰∏≠ÁôªÂΩïÁΩëÊòì‰∫ëË¥¶Âè∑„ÄÇÂ¶ÇÊûúÂá∫Áé∞È™åËØÅÁ†ÅÔºåËØ∑ÂÆåÊàêÈ™åËØÅÂêéÁÇπÂáª"È™åËØÅÂÆåÊàêÔºåÈáçËØï"'}},Be=async()=>{D.value={type:"info",message:"Ê≠£Âú®ÈáçÊñ∞ÁîüÊàê‰∫åÁª¥Á†Å..."},await Ie()},Re=async()=>{try{const m=await Pe.getHotSearch();m.success&&(T.value=m.keywords.slice(0,10))}catch(m){console.error("Ëé∑ÂèñÁÉ≠Èó®ÊêúÁ¥¢Â§±Ë¥•:",m)}},st=async()=>{if(o.value.trim().length>1)try{const m=await Pe.getSearchSuggest(o.value);m.success&&(w.value=m.suggestions.slice(0,5),S.value=!0)}catch(m){console.error("Ëé∑ÂèñÊêúÁ¥¢Âª∫ËÆÆÂ§±Ë¥•:",m)}else w.value=[],S.value=!1},Ee=async()=>{if(o.value.trim()){F.value=!0,S.value=!1;try{const m=await Pe.searchSongs(o.value,50,0);m.success?u.value=m.songs:(u.value=[],console.error("ÊêúÁ¥¢Â§±Ë¥•:",m.error))}catch(m){console.error("ÊêúÁ¥¢Â§±Ë¥•:",m),u.value=[]}finally{F.value=!1}}},P=()=>{o.value="",u.value=[],w.value=[],S.value=!1},I=m=>{o.value=m.name,S.value=!1,Ee()},L=m=>{f.value.has(m)?f.value.delete(m):f.value.add(m)},A=()=>{f.value.size===u.value.length?f.value.clear():(f.value.clear(),u.value.forEach(m=>{f.value.add(m.id)}))},R=async m=>{U.value=!0,M.value=m.name;try{console.log("ÂºÄÂßã‰∏ãËΩΩÊ≠åÊõ≤:",m.name,"ID:",m.id);const v=await Pe.getSongDetail(m.id);console.log("Ê≠åÊõ≤ËØ¶ÊÉÖ:",v);let _=null;v.success&&v.song.albumId&&(_=await Pe.getAlbumInfo(v.song.albumId),console.log("‰∏ìËæë‰ø°ÊÅØ:",_));const X=["exhigh","standard","lossless"];let me=null;for(const Q of X)if(me=await Pe.getSongUrl(m.id,Q),me.success&&me.url){console.log(`ÊàêÂäüËé∑Âèñ${Q}Èü≥Ë¥®Êí≠ÊîæÈìæÊé•:`,me.url);break}if(!me||!me.success)throw new Error("Êó†Ê≥ïËé∑ÂèñÊí≠ÊîæÈìæÊé•ÔºåÂèØËÉΩÊòØVIPÊ≠åÊõ≤ÊàñÂú∞Âå∫ÈôêÂà∂");const j=await Pe.getLyrics(m.id);console.log("Ê≠åËØçËé∑ÂèñÁªìÊûú:",j.success,"Ê≠åËØçÈïøÂ∫¶:",j.lyric?.length);const Oe=j.success&&j.lyric&&j.lyric.trim().length>0&&!j.lyric.includes("Á∫ØÈü≥‰πêÔºåËØ∑Ê¨£Ëµè");console.log("ÂºÄÂßã‰∏ãËΩΩÈü≥È¢ëÊñá‰ª∂...");const re=await ae(me.url),xe=ne(),Ke=`netease_${xe}.mp3`;let De=null,fe=null;await V.saveFile(re,"songs",Ke);const we=m.cover;if(console.log("Ê≠åÊõ≤Â∞ÅÈù¢URL:",we),console.log("Ê≠åÊõ≤‰ø°ÊÅØ:",{id:m.id,name:m.name,cover:m.cover}),we)try{console.log("ÂºÄÂßã‰∏ãËΩΩÂ∞ÅÈù¢:",we);let Q=null;try{console.log("‰∏ãËΩΩÂä†ÂØÜÂ∞ÅÈù¢URL:",we),Q=await Z(we),console.log("Â∞ÅÈù¢‰∏ãËΩΩÁªìÊûú - Â§ßÂ∞è:",Q?.size,"Á±ªÂûã:",Q?.type)}catch(Y){console.warn("Â∞ÅÈù¢‰∏ãËΩΩÂ§±Ë¥•:",Y.message),console.log("Â∞Ü‰ΩøÁî®ÈªòËÆ§Â∞ÅÈù¢ÂõæÊ†á")}Q&&Q.size>500?(De=`netease_${ne()}.jpg`,await V.saveFile(Q,"covers",De),console.log("Â∞ÅÈù¢‰øùÂ≠òÊàêÂäü:",De,"Â§ßÂ∞è:",Q.size)):console.warn("ÊâÄÊúâÂ∞ÅÈù¢URLÈÉΩ‰∏ãËΩΩÂ§±Ë¥•ÔºåÂ∞Ü‰ΩøÁî®Âú®Á∫øÂ∞ÅÈù¢URL")}catch(Q){console.warn("‰∏ãËΩΩÂ∞ÅÈù¢Â§±Ë¥•:",Q),console.log("Â∞Ü‰ΩøÁî®Âú®Á∫øÂ∞ÅÈù¢URL‰Ωú‰∏∫Â§áÁî®:",we)}if(Oe)try{console.log("ÂºÄÂßã‰øùÂ≠òÊ≠åËØçÔºåÈïøÂ∫¶:",j.lyric.length);const Q=j.lyric.trim(),Y=new Blob([Q],{type:"text/plain;charset=utf-8"}),lt=`netease_${ne()}.lrc`;await V.saveFile(Y,"lyrics",lt),fe=lt,console.log("Ê≠åËØç‰øùÂ≠òÊàêÂäü:",fe)}catch(Q){console.warn("‰øùÂ≠òÊ≠åËØçÂ§±Ë¥•:",Q),fe=null}else j.success?!j.lyric||j.lyric.trim().length===0?console.log("ËØ•Ê≠åÊõ≤Ê≤°ÊúâÊ≠åËØç"):j.lyric.includes("Á∫ØÈü≥‰πêÔºåËØ∑Ê¨£Ëµè")?console.log("ËØ•Ê≠åÊõ≤‰∏∫Á∫ØÈü≥‰πêÔºåÊó†Ê≠åËØç"):console.log("Ê≠åËØçÂÜÖÂÆπÊó†ÊïàÔºåË∑≥Ëøá‰øùÂ≠ò"):console.log("Ê≠åËØçËé∑ÂèñÂ§±Ë¥•:",j.error);const Ae={id:xe,title:m.name,artist:m.artist,album:m.album,duration:Math.floor(m.duration/1e3),audioFile:Ke,coverFile:De,coverUrl:null,lrcFile:fe,source:"netease",sourceId:m.id,createdAt:new Date().toISOString()};try{const Q=await V.getFile("songs",Ke);if(Q){console.log("Èü≥È¢ëÊñá‰ª∂Â∑≤‰øùÂ≠òÔºåURL:",Q);const Y=new Audio(Q);Y.addEventListener("loadedmetadata",()=>{console.log("Èü≥È¢ëÊñá‰ª∂È™åËØÅÊàêÂäüÔºåÊó∂Èïø:",Y.duration)}),Y.addEventListener("error",ge=>{console.error("Èü≥È¢ëÊñá‰ª∂È™åËØÅÂ§±Ë¥•:",ge)}),Y.load()}}catch(Q){console.warn("È™åËØÅÈü≥È¢ëÊñá‰ª∂Â§±Ë¥•:",Q)}n("songs-imported",[Ae]);let be=`‰∏ãËΩΩÊàêÂäü: ${m.name}`;De?be+=`
‚úÖ Â∞ÅÈù¢Â∑≤‰∏ãËΩΩ`:be+=`
‚ö†Ô∏è Â∞ÅÈù¢‰∏ãËΩΩÂ§±Ë¥•Ôºå‰ΩøÁî®Âú®Á∫øÂ∞ÅÈù¢`,fe?be+=`
‚úÖ Ê≠åËØçÂ∑≤‰∏ãËΩΩ`:be+=`
‚ö†Ô∏è ËØ•Ê≠åÊõ≤Êó†Ê≠åËØçÊàñÊ≠åËØçËé∑ÂèñÂ§±Ë¥•`,alert(be)}catch(v){console.error("‰∏ãËΩΩÊ≠åÊõ≤Â§±Ë¥•:",v);let _=v.message;v.message.includes("Êó†Ê≥ïËé∑ÂèñÊí≠ÊîæÈìæÊé•")?_="Êó†Ê≥ïËé∑ÂèñÊí≠ÊîæÈìæÊé•ÔºåÂèØËÉΩÊòØVIPÊ≠åÊõ≤ÊàñÂú∞Âå∫ÈôêÂà∂":v.message.includes("Failed to fetch")?_="ÁΩëÁªúËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúÊàñAPIÊúçÂä°Áä∂ÊÄÅ":v.message.includes("Êñá‰ª∂Â§™Â∞è")&&(_="‰∏ãËΩΩÁöÑÈü≥È¢ëÊñá‰ª∂Êó†ÊïàÔºåÂèØËÉΩÊòØÁâàÊùÉÈôêÂà∂"),alert(`‰∏ãËΩΩÂ§±Ë¥•: ${_}`)}finally{U.value=!1,M.value=""}},J=async()=>{if(f.value.size===0)return;U.value=!0,h.value=0;const m=u.value.filter(j=>f.value.has(j.id)),v=[];let _=0,X=0,me=0;for(const j of m)try{M.value=j.name;const Oe=["exhigh","standard","lossless"];let re=null;for(const Y of Oe)if(re=await Pe.getSongUrl(j.id,Y),re.success&&re.url)break;if(!re||!re.success){console.warn(`Ë∑≥ËøáÊ≠åÊõ≤ ${j.name}: Êó†Ê≥ïËé∑ÂèñÊí≠ÊîæÈìæÊé•`);continue}const xe=await Pe.getLyrics(j.id),Ke=xe.success&&xe.lyric&&xe.lyric.trim().length>0&&!xe.lyric.includes("Á∫ØÈü≥‰πêÔºåËØ∑Ê¨£Ëµè"),De=await ae(re.url),fe=ne(),we=`netease_${fe}.mp3`;let Ae=null,be=null;if(await V.saveFile(De,"songs",we),j.cover)try{let Y=null;console.log(`Ê≠åÊõ≤ ${j.name} ‰∏ãËΩΩÂä†ÂØÜÂ∞ÅÈù¢URL:`,j.cover);try{const ge=await fetch(j.cover,{mode:"cors",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",Referer:"https://music.163.com/"}});ge.ok&&(Y=await ge.blob(),console.log(`Ê≠åÊõ≤ ${j.name} Â∞ÅÈù¢‰∏ãËΩΩÊàêÂäüÔºåÂ§ßÂ∞è:`,Y.size))}catch(ge){console.warn(`Ê≠åÊõ≤ ${j.name} Â∞ÅÈù¢‰∏ãËΩΩÂ§±Ë¥•:`,ge.message)}Y&&Y.size>500?(Ae=`netease_${ne()}.jpg`,await V.saveFile(Y,"covers",Ae),console.log(`Ê≠åÊõ≤ ${j.name} Â∞ÅÈù¢‰øùÂ≠òÊàêÂäüÔºåÂ§ßÂ∞è:`,Y.size)):console.warn(`Ê≠åÊõ≤ ${j.name} ÊâÄÊúâÂ∞ÅÈù¢URLÈÉΩ‰∏ãËΩΩÂ§±Ë¥•ÔºåÂ∞Ü‰ΩøÁî®Âú®Á∫øÂ∞ÅÈù¢URL`)}catch(Y){console.warn(`Ê≠åÊõ≤ ${j.name} ‰∏ãËΩΩÂ∞ÅÈù¢Â§±Ë¥•:`,Y)}if(Ke)try{const Y=xe.lyric.trim(),ge=new Blob([Y],{type:"text/plain;charset=utf-8"}),at=`netease_${ne()}.lrc`;await V.saveFile(ge,"lyrics",at),be=at,console.log(`Ê≠åÊõ≤ ${j.name} Ê≠åËØç‰øùÂ≠òÊàêÂäü`)}catch(Y){console.warn(`Ê≠åÊõ≤ ${j.name} ‰øùÂ≠òÊ≠åËØçÂ§±Ë¥•:`,Y),be=null}else console.log(`Ê≠åÊõ≤ ${j.name} Ê≤°ÊúâÊúâÊïàÊ≠åËØçÔºåË∑≥ËøáÊ≠åËØç‰øùÂ≠ò`);const Q={id:fe,title:j.name,artist:j.artist,album:j.album,duration:Math.floor(j.duration/1e3),audioFile:we,coverFile:Ae,coverUrl:Ae?null:j.cover,lrcFile:be,source:"netease",sourceId:j.id,createdAt:new Date().toISOString()};v.push(Q),_++,Ae&&X++,be&&me++,h.value++}catch(Oe){console.warn(`‰∏ãËΩΩÊ≠åÊõ≤ ${j.name} Â§±Ë¥•:`,Oe)}if(v.length>0){n("songs-imported",v);let j=`ÊâπÈáè‰∏ãËΩΩÂÆåÊàêÔºÅ
`;j+=`‚úÖ ÊàêÂäü‰∏ãËΩΩ ${_} È¶ñÊ≠åÊõ≤
`,j+=`üñºÔ∏è Â∞ÅÈù¢‰∏ãËΩΩ ${X} ‰∏™
`,j+=`üìù Ê≠åËØç‰∏ãËΩΩ ${me} ‰∏™`,m.length>_&&(j+=`
‚ö†Ô∏è ${m.length-_} È¶ñÊ≠åÊõ≤‰∏ãËΩΩÂ§±Ë¥•`),alert(j)}else alert("ÊâπÈáè‰∏ãËΩΩÂ§±Ë¥•ÔºåÊ≤°ÊúâÊàêÂäü‰∏ãËΩΩ‰ªª‰ΩïÊ≠åÊõ≤");U.value=!1,f.value.clear(),M.value="",h.value=0},ae=async m=>{console.log("ÂºÄÂßã‰∏ãËΩΩÈü≥È¢ëÊñá‰ª∂:",m);const v=await fetch(m,{mode:"cors",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",Referer:"https://music.163.com/"}});if(console.log("Èü≥È¢ë‰∏ãËΩΩÂìçÂ∫îÁä∂ÊÄÅ:",v.status,v.headers.get("content-type")),!v.ok)throw new Error(`Èü≥È¢ë‰∏ãËΩΩÂ§±Ë¥•: ${v.status} ${v.statusText}`);const _=await v.blob();if(console.log("‰∏ãËΩΩÁöÑÈü≥È¢ëÊñá‰ª∂Â§ßÂ∞è:",_.size,"Á±ªÂûã:",_.type),_.size<1e4)throw new Error("‰∏ãËΩΩÁöÑÈü≥È¢ëÊñá‰ª∂Â§™Â∞èÔºåÂèØËÉΩÊòØÊó†ÊïàÊñá‰ª∂");const X=v.headers.get("content-type")||"audio/mpeg";return new Blob([_],{type:X})},Z=async m=>{console.log("ÂºÄÂßã‰∏ãËΩΩÂõæÁâáÊñá‰ª∂:",m);const v=await fetch(m,{mode:"cors",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",Referer:"https://music.163.com/"}});if(console.log("ÂõæÁâá‰∏ãËΩΩÂìçÂ∫î:",{status:v.status,statusText:v.statusText,contentType:v.headers.get("content-type"),contentLength:v.headers.get("content-length"),url:v.url}),!v.ok)throw new Error(`ÂõæÁâá‰∏ãËΩΩÂ§±Ë¥•: ${v.status} ${v.statusText}`);const _=await v.blob();if(console.log("‰∏ãËΩΩÁöÑÂõæÁâáÊñá‰ª∂:",{size:_.size,type:_.type,sizeKB:Math.round(_.size/1024)+"KB"}),_.size<500)throw new Error(`‰∏ãËΩΩÁöÑÂõæÁâáÊñá‰ª∂Â§™Â∞è: ${_.size} bytes`);const X=v.headers.get("content-type")||"image/jpeg";if(!X.startsWith("image/"))throw new Error("‰∏ãËΩΩÁöÑ‰∏çÊòØÂõæÁâáÊñá‰ª∂");return new Blob([_],{type:X})},ee=m=>{const v=Math.floor(m/1e3),_=Math.floor(v/60),X=v%60;return`${_}:${X.toString().padStart(2,"0")}`};return We(async()=>{await Se(),$.value&&await Re()}),(m,v)=>(d(),g("div",Ro,[e("div",Eo,[v[8]||(v[8]=e("div",{class:"header-info"},[e("div",{class:"info-icon"},"üéµ"),e("div",{class:"info-content"},[e("h3",null,"ÁΩëÊòì‰∫ëÈü≥‰πêÂú®Á∫øÊêúÁ¥¢"),e("p",null,"Âú®Á∫øÊêúÁ¥¢Âπ∂‰∏ãËΩΩÁΩëÊòì‰∫ëÈü≥‰πêÂà∞Êú¨Âú∞Èü≥‰πêÂ∫ì")])],-1)),e("div",Oo,[e("div",{class:G(["api-status",{online:$.value,offline:!$.value}])},[v[6]||(v[6]=e("span",{class:"status-dot"},null,-1)),e("span",qo,k($.value?"APIÂú®Á∫ø":"APIÁ¶ªÁ∫ø"),1)],2),e("div",{class:G(["vip-status",{vip:O.value.isVip,black:O.value.isBlackVip,super:O.value.isSuperVip}])},[O.value.isLogin?(d(),g("span",Vo,[H(" üë§ "+k(O.value.nickname)+" ",1),O.value.isSuperVip?(d(),g("span",Ho,"ÈªëËÉ∂SVIP")):O.value.isBlackVip?(d(),g("span",Go,"ÈªëËÉ∂VIP")):O.value.isVip?(d(),g("span",Wo,"VIP")):(d(),g("span",Zo,"ÂÖçË¥πÁî®Êà∑")),e("button",{onClick:ie,class:"logout-btn",title:"ÈÄÄÂá∫ÁôªÂΩï"},"üö™")])):(d(),g("span",Yo,[v[7]||(v[7]=H(" üë§ Ê∏∏ÂÆ¢Ê®°Âºè ")),e("button",{onClick:v[0]||(v[0]=_=>N.value=!0),class:"login-btn"},"ÁôªÂΩï")]))],2)])]),e("div",Ko,[e("div",Qo,[te(e("input",{ref_key:"searchInput",ref:K,type:"text","onUpdate:modelValue":v[1]||(v[1]=_=>o.value=_),onInput:st,onKeyup:ns(Ee,["enter"]),placeholder:"ÊêúÁ¥¢Ê≠åÊõ≤„ÄÅËâ∫ÊúØÂÆ∂Êàñ‰∏ìËæë...",class:"search-input",disabled:!$.value},null,40,Jo),[[Ne,o.value]]),e("button",{class:"search-btn",onClick:Ee,disabled:!o.value.trim()||F.value||!$.value},[F.value?(d(),g("div",ea)):(d(),g("svg",ta,v[9]||(v[9]=[e("path",{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},null,-1)])))],8,Xo),o.value?(d(),g("button",{key:0,class:"clear-btn",onClick:P},v[10]||(v[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))):q("",!0)]),w.value.length>0&&S.value?(d(),g("div",sa,[(d(!0),g(ce,null,de(w.value,_=>(d(),g("div",{key:_.id,class:"suggestion-item",onClick:X=>I(_)},[e("span",oa,k(_.type==="song"?"üéµ":"üë§"),1),e("span",aa,k(_.name),1),_.artist?(d(),g("span",na,"- "+k(_.artist),1)):q("",!0)],8,la))),128))])):q("",!0),!o.value&&T.value.length>0?(d(),g("div",ia,[v[11]||(v[11]=e("h4",null,"ÁÉ≠Èó®ÊêúÁ¥¢",-1)),e("div",ra,[(d(!0),g(ce,null,de(T.value,_=>(d(),g("button",{key:_,class:"hot-keyword",onClick:X=>{o.value=_,Ee()}},k(_),9,ca))),128))])])):q("",!0)]),u.value.length>0?(d(),g("div",da,[e("div",ua,[e("h4",null,"ÊêúÁ¥¢ÁªìÊûú ("+k(u.value.length)+" È¶ñÊ≠åÊõ≤)",1),e("div",va,[e("button",{class:"action-btn",onClick:A},k(f.value.size===u.value.length?"ÂèñÊ∂àÂÖ®ÈÄâ":"ÂÖ®ÈÄâ"),1),e("button",{class:"action-btn primary",onClick:J,disabled:f.value.size===0||U.value},[U.value?(d(),g("div",pa)):q("",!0),H(" ‰∏ãËΩΩÈÄâ‰∏≠ ("+k(f.value.size)+") ",1)],8,ga)])]),e("div",ya,[(d(!0),g(ce,null,de(u.value,_=>(d(),g("div",{key:_.id,class:G(["song-item",{selected:f.value.has(_.id)}]),onClick:X=>L(_.id)},[e("div",ma,[e("input",{type:"checkbox",checked:f.value.has(_.id),onChange:X=>L(_.id)},null,40,fa)]),e("div",ba,[e("img",{src:_.cover||s,alt:_.name,onError:r,onLoad:i},null,40,wa)]),e("div",ka,[e("div",$a,k(_.name),1),e("div",Ca,[e("span",Sa,k(_.artist),1),e("span",Ia,k(_.album),1),e("span",Ma,k(ee(_.duration)),1)])]),e("div",xa,[e("button",{class:"action-btn download-btn",onClick:se(X=>R(_),["stop"]),disabled:U.value},v[12]||(v[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"})],-1),H(" ‰∏ãËΩΩ ")]),8,_a)])],10,ha))),128))])])):q("",!0),U.value?(d(),g("div",Pa,[e("div",La,[e("span",null,"Ê≠£Âú®‰∏ãËΩΩ: "+k(M.value),1),e("span",null,"ËøõÂ∫¶: "+k(h.value)+" / "+k(f.value.size),1)]),e("div",Da,[e("div",{class:"progress-fill",style:ze({width:h.value/f.value.size*100+"%"})},null,4)])])):q("",!0),v[26]||(v[26]=e("div",{class:"usage-info"},[e("div",{class:"info-card"},[e("div",{class:"info-icon"},"üí°"),e("div",{class:"info-content"},[e("h4",null,"‰ΩøÁî®ËØ¥Êòé"),e("ul",null,[e("li",null,"Á°Æ‰øùÁΩëÊòì‰∫ëÈü≥‰πêAPIÊúçÂä°Ê≠£Âú®ËøêË°å"),e("li",null,"ÊêúÁ¥¢ÊÇ®ÂñúÊ¨¢ÁöÑÊ≠åÊõ≤„ÄÅËâ∫ÊúØÂÆ∂Êàñ‰∏ìËæë"),e("li",null,"ÈÄâÊã©Ë¶Å‰∏ãËΩΩÁöÑÊ≠åÊõ≤ÔºåÁÇπÂáª‰∏ãËΩΩÊåâÈíÆ"),e("li",null,"‰∏ãËΩΩÁöÑÈü≥‰πêÂ∞ÜËá™Âä®‰øùÂ≠òÂà∞Êú¨Âú∞Èü≥‰πêÂ∫ì"),e("li",null,"ÊîØÊåÅÊâπÈáè‰∏ãËΩΩÂíåÊ≠åËØçËé∑Âèñ")])])])],-1)),N.value?(d(),g("div",{key:2,class:"login-modal-overlay",onClick:oe},[e("div",{class:"login-modal",onClick:v[5]||(v[5]=se(()=>{},["stop"]))},[e("div",{class:"login-header"},[v[13]||(v[13]=e("h3",null,"üéµ ÁΩëÊòì‰∫ëÈü≥‰πêÁôªÂΩï",-1)),e("button",{onClick:oe,class:"close-btn"},"√ó")]),e("div",Aa,[e("div",Ua,[e("div",Ta,[e("div",{class:"option-card"},[v[14]||(v[14]=e("h4",null,"üîó ÊµèËßàÂô®ÁôªÂΩïÔºàÊé®ËçêÔºâ",-1)),v[15]||(v[15]=e("p",null,"Âú®ÊµèËßàÂô®‰∏≠ÁôªÂΩïÁΩëÊòì‰∫ëÈü≥‰πêÔºåÁÑ∂ÂêéÊâãÂä®ÈÖçÁΩÆCookie",-1)),e("button",{onClick:Me,class:"browser-login-btn"}," ÊâìÂºÄÁôªÂΩïÈ°µÈù¢ ")]),e("div",Fa,[v[16]||(v[16]=e("h4",null,"üì± ‰∫åÁª¥Á†ÅÁôªÂΩï",-1)),v[17]||(v[17]=e("p",null,"‰ΩøÁî®ÁΩëÊòì‰∫ëÈü≥‰πêAPPÊâ´Êèè‰∫åÁª¥Á†ÅÁôªÂΩï",-1)),e("button",{onClick:Ie,class:"generate-qr-btn",disabled:p.value},k(p.value?"ÁîüÊàê‰∏≠...":"ÁîüÊàê‰∫åÁª¥Á†Å"),9,za)])]),x.value.unikey?(d(),g("div",Na,[e("div",ja,[x.value.qrImage?(d(),g("div",Ba,[e("img",{src:x.value.qrImage,alt:"ÁôªÂΩï‰∫åÁª¥Á†Å",class:"qr-image",onError:Ze},null,40,Ra),B.value?(d(),g("div",Ea,[v[19]||(v[19]=e("div",{class:"qr-text"},"‰∫åÁª¥Á†ÅÂä†ËΩΩÂ§±Ë¥•",-1)),e("div",Oa,[v[18]||(v[18]=e("p",null,"ËØ∑Â§çÂà∂‰ª•‰∏ãÈìæÊé•Âà∞ÊµèËßàÂô®ÊâìÂºÄÔºö",-1)),e("input",{value:x.value.qrUrl,readonly:"",class:"qr-url-input",onClick:Le},null,8,qa),e("button",{onClick:Le,class:"copy-btn"},"Â§çÂà∂ÈìæÊé•")])])):q("",!0)])):(d(),g("div",Va,"‰∫åÁª¥Á†ÅÁîüÊàê‰∏≠..."))]),e("div",Ha,[v[22]||(v[22]=e("p",null,"üì± ËØ∑‰ΩøÁî®ÁΩëÊòì‰∫ëÈü≥‰πêAPPÊâ´Êèè‰∫åÁª¥Á†Å",-1)),e("p",{class:G(["login-status",D.value.type])},k(D.value.message),3),D.value.type==="captcha"?(d(),g("div",Ga,[v[21]||(v[21]=e("div",{class:"captcha-notice"},[e("p",{class:"captcha-warning"},"‚ö†Ô∏è ÈúÄË¶ÅÂÆåÊàêÂÆâÂÖ®È™åËØÅ"),e("p",{class:"captcha-tip"},"ËØ∑Âú®ÊµèËßàÂô®‰∏≠ÂÆåÊàê‰∫∫Êú∫È™åËØÅÂêéÈáçËØïÁôªÂΩï")],-1)),e("div",Wa,[e("button",{onClick:Ye,class:"captcha-btn"},"üåê ÊâìÂºÄÁôªÂΩïÈ°µÈù¢"),e("button",{onClick:Be,class:"retry-btn"},"‚úÖ È™åËØÅÂÆåÊàêÔºåÈáçËØï"),e("button",{onClick:v[2]||(v[2]=(..._)=>m.showManualCookieHelp&&m.showManualCookieHelp(..._)),class:"manual-help-btn"},"üìã ÊâãÂä®Ëé∑ÂèñCookie")]),m.showCookieHelp?(d(),g("div",Za,[v[20]||(v[20]=Mt('<h5 data-v-1b359262>üîß ÊâãÂä®Ëé∑ÂèñCookieÊñπÊ≥ïÔºö</h5><ol class="cookie-help-steps" data-v-1b359262><li data-v-1b359262>Âú®Êñ∞Á™óÂè£‰∏≠ÁôªÂΩï <a href="https://music.163.com" target="_blank" data-v-1b359262>music.163.com</a></li><li data-v-1b359262>ÁôªÂΩïÊàêÂäüÂêéÔºåÊåâ <kbd data-v-1b359262>F12</kbd> ÊâìÂºÄÂºÄÂèëËÄÖÂ∑•ÂÖ∑</li><li data-v-1b359262>ÂàáÊç¢Âà∞ <strong data-v-1b359262>Application</strong> Êàñ <strong data-v-1b359262>Â≠òÂÇ®</strong> Ê†áÁ≠æ</li><li data-v-1b359262>Âú®Â∑¶‰æßÊâæÂà∞ <strong data-v-1b359262>Cookies</strong> ‚Üí <strong data-v-1b359262>https://music.163.com</strong></li><li data-v-1b359262>ÊâæÂà∞Âêç‰∏∫ <strong data-v-1b359262>MUSIC_U</strong> ÁöÑCookieÔºåÂ§çÂà∂ÂÖ∂ÂÄº</li><li data-v-1b359262>Â∞ÜCookieÂÄºÁ≤òË¥¥Âà∞‰∏ãÊñπÁöÑÊâãÂä®CookieËæìÂÖ•Ê°Ü‰∏≠</li></ol>',2)),e("button",{onClick:v[3]||(v[3]=_=>m.showCookieHelp=!1),class:"close-help-btn"},"ÂÖ≥Èó≠Â∏ÆÂä©")])):q("",!0)])):q("",!0)]),e("div",{class:"login-actions"},[e("button",{onClick:Ie,class:"refresh-qr-btn"},"Âà∑Êñ∞‰∫åÁª¥Á†Å"),e("button",{onClick:oe,class:"cancel-btn"},"ÂèñÊ∂à")])])):q("",!0),e("div",Ya,[v[23]||(v[23]=e("h4",null,"üîß ÊâãÂä®ÈÖçÁΩÆCookie",-1)),v[24]||(v[24]=e("p",null,"Â¶ÇÊûúËá™Âä®ÁôªÂΩïÂ§±Ë¥•ÔºåÊÇ®ÂèØ‰ª•ÊâãÂä®ÈÖçÁΩÆCookieÔºö",-1)),v[25]||(v[25]=e("ol",{class:"cookie-steps"},[e("li",null,[H("Âú®ÊµèËßàÂô®‰∏≠ÁôªÂΩï "),e("a",{href:"https://music.163.com",target:"_blank"},"music.163.com")]),e("li",null,"ÊåâF12ÊâìÂºÄÂºÄÂèëËÄÖÂ∑•ÂÖ∑ ‚Üí NetworkÊ†áÁ≠æ"),e("li",null,"Âà∑Êñ∞È°µÈù¢ÔºåÊâæÂà∞‰ªªÊÑèËØ∑Ê±ÇÔºåÂ§çÂà∂Cookie‰∏≠ÁöÑMUSIC_UÂÄº"),e("li",null,"Â∞ÜCookieÁ≤òË¥¥Âà∞‰∏ãÊñπËæìÂÖ•Ê°ÜÔºö")],-1)),e("div",Ka,[te(e("textarea",{"onUpdate:modelValue":v[4]||(v[4]=_=>W.value=_),placeholder:"MUSIC_U=‰Ω†ÁöÑÂÄº;os=pc;appver=8.9.70;",class:"cookie-input",rows:"3"},null,512),[[Ne,W.value]]),e("button",{onClick:Je,class:"update-cookie-btn",disabled:!W.value.trim()}," Êõ¥Êñ∞Cookie ",8,Qa)])])])])])])):q("",!0)]))}},Xa=ue(Ja,[["__scopeId","data-v-1b359262"]]),he=b(!1),_t=async()=>{try{const a=await V.getTheme();he.value=a==="dark",console.log(`‰ªéÊï∞ÊçÆÂ∫ìÂä†ËΩΩ‰∏ªÈ¢òËÆæÁΩÆ: ${a}`)}catch(a){console.error("Âä†ËΩΩ‰∏ªÈ¢òËÆæÁΩÆÂ§±Ë¥•:",a);const c=localStorage.getItem("music-player-theme");c?(he.value=c==="dark",await V.saveTheme(he.value),localStorage.removeItem("music-player-theme"),console.log("Â∑≤ËøÅÁßª‰∏ªÈ¢òËÆæÁΩÆÂà∞Êï∞ÊçÆÂ∫ì")):(he.value=!1,await V.saveTheme(!1))}},en=async()=>{await _t(),ot()},ot=()=>{const a=document.documentElement;he.value?(a.style.setProperty("--bg-primary","linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%)"),a.style.setProperty("--bg-secondary","rgba(15, 23, 42, 0.9)"),a.style.setProperty("--bg-tertiary","rgba(30, 41, 59, 0.95)"),a.style.setProperty("--bg-card","rgba(30, 41, 59, 0.8)"),a.style.setProperty("--bg-card-hover","rgba(51, 65, 85, 0.9)"),a.style.setProperty("--bg-overlay","rgba(15, 23, 42, 0.95)"),a.style.setProperty("--bg-surface","rgba(30, 41, 59, 0.8)"),a.style.setProperty("--bg-surface-hover","rgba(51, 65, 85, 0.9)"),a.style.setProperty("--bg-sidebar","linear-gradient(180deg, rgba(15, 23, 42, 0.95) 0%, rgba(30, 41, 59, 0.9) 100%)"),a.style.setProperty("--text-primary","#f8fafc"),a.style.setProperty("--text-secondary","rgba(248, 250, 252, 0.8)"),a.style.setProperty("--text-tertiary","rgba(248, 250, 252, 0.6)"),a.style.setProperty("--text-muted","rgba(248, 250, 252, 0.5)"),a.style.setProperty("--border-primary","rgba(248, 250, 252, 0.1)"),a.style.setProperty("--border-secondary","rgba(248, 250, 252, 0.2)"),a.style.setProperty("--border-light","rgba(248, 250, 252, 0.15)"),a.style.setProperty("--border-medium","rgba(248, 250, 252, 0.25)"),a.style.setProperty("--shadow-light","0 4px 16px rgba(0, 0, 0, 0.3)"),a.style.setProperty("--shadow-medium","0 8px 24px rgba(0, 0, 0, 0.4)"),a.style.setProperty("--shadow-heavy","0 12px 32px rgba(0, 0, 0, 0.5)"),a.style.setProperty("--shadow-sm","0 2px 8px rgba(0, 0, 0, 0.2)"),a.style.setProperty("--shadow-md","0 4px 16px rgba(0, 0, 0, 0.3)"),a.style.setProperty("--color-primary","#667eea"),a.style.setProperty("--color-primary-light","rgba(102, 126, 234, 0.2)"),a.style.setProperty("--color-primary-medium","rgba(102, 126, 234, 0.4)"),a.style.setProperty("--color-gradient","linear-gradient(135deg, #667eea 0%, #764ba2 100%)"),document.body.classList.add("dark-theme"),document.body.classList.remove("light-theme")):(a.style.setProperty("--bg-primary","linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%)"),a.style.setProperty("--bg-secondary","rgba(255, 255, 255, 0.8)"),a.style.setProperty("--bg-tertiary","rgba(255, 255, 255, 0.95)"),a.style.setProperty("--bg-card","rgba(255, 255, 255, 0.8)"),a.style.setProperty("--bg-card-hover","rgba(255, 255, 255, 0.95)"),a.style.setProperty("--bg-overlay","rgba(255, 255, 255, 0.9)"),a.style.setProperty("--bg-surface","rgba(255, 255, 255, 0.8)"),a.style.setProperty("--bg-surface-hover","rgba(255, 255, 255, 0.95)"),a.style.setProperty("--bg-sidebar","linear-gradient(180deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.9) 100%)"),a.style.setProperty("--text-primary","#1e293b"),a.style.setProperty("--text-secondary","rgba(0, 0, 0, 0.7)"),a.style.setProperty("--text-tertiary","rgba(0, 0, 0, 0.6)"),a.style.setProperty("--text-muted","rgba(0, 0, 0, 0.5)"),a.style.setProperty("--border-primary","rgba(0, 0, 0, 0.1)"),a.style.setProperty("--border-secondary","rgba(0, 0, 0, 0.2)"),a.style.setProperty("--border-light","rgba(0, 0, 0, 0.15)"),a.style.setProperty("--border-medium","rgba(0, 0, 0, 0.25)"),a.style.setProperty("--shadow-light","0 4px 16px rgba(0, 0, 0, 0.1)"),a.style.setProperty("--shadow-medium","0 8px 24px rgba(0, 0, 0, 0.15)"),a.style.setProperty("--shadow-heavy","0 12px 32px rgba(0, 0, 0, 0.2)"),a.style.setProperty("--shadow-sm","0 2px 8px rgba(0, 0, 0, 0.1)"),a.style.setProperty("--shadow-md","0 4px 16px rgba(0, 0, 0, 0.15)"),a.style.setProperty("--color-primary","#667eea"),a.style.setProperty("--color-primary-light","rgba(102, 126, 234, 0.2)"),a.style.setProperty("--color-primary-medium","rgba(102, 126, 234, 0.4)"),a.style.setProperty("--color-gradient","linear-gradient(135deg, #667eea 0%, #764ba2 100%)"),document.body.classList.add("light-theme"),document.body.classList.remove("dark-theme"))},tn=async()=>{he.value=!he.value,ot();try{await V.saveTheme(he.value),console.log(`Â∑≤ÂàáÊç¢Âà∞${he.value?"Â§úÊôö":"Êó•Èó¥"}Ê®°ÂºèÂπ∂‰øùÂ≠òÂà∞Êï∞ÊçÆÂ∫ì`)}catch(a){console.error("‰øùÂ≠ò‰∏ªÈ¢òËÆæÁΩÆÂ§±Ë¥•:",a),localStorage.setItem("music-player-theme",he.value?"dark":"light")}};Ge(he,async a=>{try{await V.saveTheme(a)}catch(c){console.error("Ëá™Âä®‰øùÂ≠ò‰∏ªÈ¢òËÆæÁΩÆÂ§±Ë¥•:",c),localStorage.setItem("music-player-theme",a?"dark":"light")}},{immediate:!1});function sn(){return{isDarkMode:he,toggleTheme:tn,loadTheme:en,applyTheme:ot}}_t().then(()=>{ot()}).catch(a=>{console.error("ÂàùÂßãÂåñ‰∏ªÈ¢òÂ§±Ë¥•:",a),he.value=!1,ot()});const ln={class:"resource-manager"},on={class:"assets-section"},an={class:"section-header"},nn={class:"assets-list"},rn={key:0,class:"empty-message"},cn={class:"asset-info"},dn={class:"asset-name"},un={class:"asset-meta"},vn={class:"asset-filename"},gn={class:"asset-actions"},pn=["onClick"],yn=["onClick"],hn={class:"assets-section"},mn={class:"section-header"},fn={class:"assets-list"},bn={key:0,class:"empty-message"},wn={class:"asset-info"},kn={class:"asset-name"},$n={class:"asset-meta"},Cn={class:"asset-filename"},Sn={class:"asset-actions"},In=["onClick"],Mn=["onClick"],xn={class:"storage-info"},_n={__name:"ResourceManager",emits:["close","assets-changed"],setup(a,{emit:c}){const n=c,s=b([]),r=b([]),i=M=>new Date(M).toLocaleString("zh-CN"),o=async()=>{try{await V.init(),s.value=await V.getAllFiles("songs"),r.value=await V.getAllFiles("covers")}catch(M){console.error("Âà∑Êñ∞ËµÑÊ∫êÂ§±Ë¥•:",M)}},u=async(M,h)=>{try{await V.downloadFile(M,h)}catch($){console.error("‰∏ãËΩΩÊñá‰ª∂Â§±Ë¥•:",$),alert("‰∏ãËΩΩÂ§±Ë¥•ÔºåËØ∑ÈáçËØï")}},f=async(M,h)=>{if(confirm("Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Êñá‰ª∂ÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§ç„ÄÇ"))try{await V.deleteFile(M,h),await o(),n("assets-changed"),alert("Êñá‰ª∂Â∑≤Âà†Èô§")}catch($){console.error("Âà†Èô§Êñá‰ª∂Â§±Ë¥•:",$),alert("Âà†Èô§Â§±Ë¥•ÔºåËØ∑ÈáçËØï")}},F=async()=>{try{const M=await V.exportAssets(),h=JSON.stringify(M,null,2),$=new Blob([h],{type:"application/json"}),w=URL.createObjectURL($),S=document.createElement("a");S.href=w,S.download=`music-assets-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(w)}catch(M){console.error("ÂØºÂá∫Â§±Ë¥•:",M),alert("ÂØºÂá∫Â§±Ë¥•ÔºåËØ∑ÈáçËØï")}},U=()=>{n("close")};return We(()=>{o()}),(M,h)=>(d(),g("div",ln,[e("div",{class:"manager-header"},[h[0]||(h[0]=e("h3",null,"ÈùôÊÄÅËµÑÊ∫êÁÆ°ÁêÜ",-1)),e("div",{class:"manager-actions"},[e("button",{onClick:o,class:"refresh-btn"},"Âà∑Êñ∞"),e("button",{onClick:F,class:"export-btn"},"ÂØºÂá∫Ê∏ÖÂçï"),e("button",{onClick:U,class:"close-btn"},"ÂÖ≥Èó≠")])]),e("div",on,[e("div",an,[e("h4",null,"üéµ Èü≥È¢ëÊñá‰ª∂ ("+k(s.value.length)+")",1)]),e("div",nn,[s.value.length===0?(d(),g("div",rn," ÊöÇÊó†Èü≥È¢ëÊñá‰ª∂ ")):q("",!0),(d(!0),g(ce,null,de(s.value,$=>(d(),g("div",{key:$.id,class:"asset-item"},[e("div",cn,[e("div",dn,k($.originalName),1),e("div",un,k(He(Fe)($.size))+" | "+k(i($.createdAt)),1),e("div",vn,k($.filename),1)]),e("div",gn,[e("button",{onClick:w=>u("songs",$.filename),class:"download-btn"}," ‰∏ãËΩΩ ",8,pn),e("button",{onClick:w=>f("songs",$.filename),class:"delete-btn"}," Âà†Èô§ ",8,yn)])]))),128))])]),e("div",hn,[e("div",mn,[e("h4",null,"üñºÔ∏è Â∞ÅÈù¢ÂõæÁâá ("+k(r.value.length)+")",1)]),e("div",fn,[r.value.length===0?(d(),g("div",bn," ÊöÇÊó†Â∞ÅÈù¢ÂõæÁâá ")):q("",!0),(d(!0),g(ce,null,de(r.value,$=>(d(),g("div",{key:$.id,class:"asset-item"},[e("div",wn,[e("div",kn,k($.originalName),1),e("div",$n,k(He(Fe)($.size))+" | "+k(i($.createdAt)),1),e("div",Cn,k($.filename),1)]),e("div",Sn,[e("button",{onClick:w=>u("covers",$.filename),class:"download-btn"}," ‰∏ãËΩΩ ",8,In),e("button",{onClick:w=>f("covers",$.filename),class:"delete-btn"}," Âà†Èô§ ",8,Mn)])]))),128))])]),e("div",xn,[e("p",null,"ÊÄªËÆ°: "+k(s.value.length+r.value.length)+" ‰∏™Êñá‰ª∂",1),h[1]||(h[1]=e("p",null,"Â≠òÂÇ®‰ΩçÁΩÆ: ÊµèËßàÂô® IndexedDB",-1))])]))}},Pn=ue(_n,[["__scopeId","data-v-113d9578"]]),Ln={class:"favorites-container"},Dn={class:"content-header"},An={class:"header-info"},Un={class:"song-count"},Tn={class:"content-body"},Fn={key:0,class:"empty-state"},zn={key:1,class:"favorites-grid"},Nn={__name:"FavoritesList",props:{playlist:Array,currentSong:Object,isPlaying:Boolean,getCoverUrl:Function,playlists:{type:Array,default:()=>[]}},emits:["play-song","toggle-favorite","navigate","delete-song","add-to-playlist"],setup(a,{emit:c}){const n=a,s=Ce(()=>n.playlist.filter(i=>i.isFavorite)),r=Ce(()=>s.value.length);return(i,o)=>(d(),g("div",Ln,[e("div",Dn,[o[5]||(o[5]=e("div",{class:"header-title"},[e("span",{class:"title-icon"},"‚ù§Ô∏è"),e("h1",null,"ÊàëÂñúÊ¨¢ÁöÑ")],-1)),e("div",An,[e("span",Un,k(r.value)+" È¶ñÊ≠åÊõ≤",1)])]),e("div",Tn,[r.value===0?(d(),g("div",Fn,[o[7]||(o[7]=e("div",{class:"empty-icon"},"üíî",-1)),o[8]||(o[8]=e("h3",{class:"empty-title"},"ËøòÊ≤°ÊúâÊî∂ËóèÁöÑÊ≠åÊõ≤",-1)),o[9]||(o[9]=e("p",{class:"empty-description"},"ÁÇπÂáªÊ≠åÊõ≤Âç°ÁâáÂè≥‰∏äËßíÁöÑÁà±ÂøÉÊù•Êî∂Ëóè‰Ω†ÂñúÊ¨¢ÁöÑÈü≥‰πê",-1)),e("button",{class:"back-to-library-btn",onClick:o[0]||(o[0]=u=>i.$emit("navigate","library"))},o[6]||(o[6]=[e("span",{class:"btn-icon"},"üé∂",-1),H(" ËøîÂõûÈü≥‰πêÂ∫ì ")]))])):(d(),g("div",zn,[Te(gt,{playlist:s.value,"current-song":a.currentSong,"is-playing":a.isPlaying,"get-cover-url":a.getCoverUrl,playlists:a.playlists,onPlaySong:o[1]||(o[1]=u=>i.$emit("play-song",u)),onToggleFavorite:o[2]||(o[2]=u=>i.$emit("toggle-favorite",u)),onDeleteSong:o[3]||(o[3]=u=>i.$emit("delete-song",u)),onAddToPlaylist:o[4]||(o[4]=(u,f)=>i.$emit("add-to-playlist",u,f))},null,8,["playlist","current-song","is-playing","get-cover-url","playlists"])]))])]))}},jn=ue(Nn,[["__scopeId","data-v-a4d25e5d"]]),Bn={class:"modal-header"},Rn={class:"modal-body"},En={class:"form-group"},On={class:"form-group"},qn={class:"form-group"},Vn={class:"cover-selection"},Hn={class:"cover-preview"},Gn=["src"],Wn={class:"form-actions"},Zn=["disabled"],Yn={__name:"CreatePlaylistModal",props:{playlist:{type:Object,default:null}},emits:["save","close"],setup(a,{emit:c}){const n=a,s=c,r=b({name:"",description:"",cover:null}),i=b(null);function o(){return"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjNjY3ZWVhIi8+CjxwYXRoIGQ9Ik0xMDAgNTBDMTI3LjYxNCA1MCA1MCA3Ny4zODU4IDUwIDEwNUM1MCAxMzIuNjE0IDc3LjM4NTggMTYwIDEwNSAxNjBDMTMyLjYxNCAxNjAgMTYwIDEzMi42MTQgMTYwIDEwNUMxNjAgNzcuMzg1OCAxMzIuNjE0IDUwIDEwNSA1MEgxMDBWNTBaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPGNpcmNsZSBjeD0iMTA1IiBjeT0iMTA1IiByPSIyMCIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGQ9Ik0xMDAgODBMMTIwIDEwMEwxMDAgMTIwVjgwWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+"}const u=Ce(()=>!!n.playlist),f=b(o()),F=()=>{r.value={name:"",description:"",cover:null},f.value=o()};Ge(()=>n.playlist,S=>{S?(r.value={name:S.name||"",description:S.description||"",cover:S.cover||null},f.value=S.cover||o()):F()},{immediate:!0});const U=()=>{i.value?.click()},M=S=>{const T=S.target.files[0];if(T){if(T.size>5*1024*1024){alert("ÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá5MB");return}const K=new FileReader;K.onload=O=>{const N=O.target.result;r.value.cover=N,f.value=N},K.readAsDataURL(T)}},h=()=>{r.value.cover=null,f.value=o()},$=()=>{if(!r.value.name.trim()){alert("ËØ∑ËæìÂÖ•Ê≠åÂçïÂêçÁß∞");return}const S={name:r.value.name.trim(),description:r.value.description.trim(),cover:r.value.cover,songs:n.playlist?.songs||[],createdAt:n.playlist?.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()};s("save",S)},w=()=>{s("close")};return We(()=>{console.log("CreatePlaylistModal mounted"),n.playlist||F()}),(S,T)=>(d(),g("div",{class:"modal-overlay",onClick:w},[e("div",{class:"modal-content",onClick:T[2]||(T[2]=se(()=>{},["stop"]))},[e("div",Bn,[e("h2",null,k(u.value?"ÁºñËæëÊ≠åÂçï":"ÂàõÂª∫Ê≠åÂçï"),1),e("button",{class:"close-btn",onClick:w},T[3]||(T[3]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))]),e("div",Rn,[e("form",{onSubmit:se($,["prevent"])},[e("div",En,[T[4]||(T[4]=e("label",{for:"playlistName"},"Ê≠åÂçïÂêçÁß∞",-1)),te(e("input",{id:"playlistName","onUpdate:modelValue":T[0]||(T[0]=K=>r.value.name=K),type:"text",placeholder:"ËØ∑ËæìÂÖ•Ê≠åÂçïÂêçÁß∞",required:"",maxlength:"50"},null,512),[[Ne,r.value.name]])]),e("div",On,[T[5]||(T[5]=e("label",{for:"playlistDescription"},"Ê≠åÂçïÊèèËø∞ÔºàÂèØÈÄâÔºâ",-1)),te(e("textarea",{id:"playlistDescription","onUpdate:modelValue":T[1]||(T[1]=K=>r.value.description=K),placeholder:"ËØ∑ËæìÂÖ•Ê≠åÂçïÊèèËø∞",rows:"3",maxlength:"200"},null,512),[[Ne,r.value.description]])]),e("div",qn,[T[8]||(T[8]=e("label",null,"Ê≠åÂçïÂ∞ÅÈù¢",-1)),e("div",Vn,[e("div",Hn,[e("img",{src:f.value,alt:"Â∞ÅÈù¢È¢ÑËßà"},null,8,Gn),e("div",{class:"cover-overlay"},[e("button",{type:"button",onClick:U,class:"change-cover-btn"}," Êõ¥Êç¢Â∞ÅÈù¢ ")])]),e("input",{ref_key:"fileInput",ref:i,type:"file",accept:"image/*",onChange:M,style:{display:"none"}},null,544),e("div",{class:"cover-options"},[e("button",{type:"button",onClick:U,class:"upload-btn"},T[6]||(T[6]=[e("span",null,"üìÅ",-1),H(" ‰∏ä‰º†ÂõæÁâá ")])),e("button",{type:"button",onClick:h,class:"default-btn"},T[7]||(T[7]=[e("span",null,"üéµ",-1),H(" ‰ΩøÁî®ÈªòËÆ§ ")]))])])]),e("div",Wn,[e("button",{type:"button",onClick:w,class:"cancel-btn"}," ÂèñÊ∂à "),e("button",{type:"submit",class:"save-btn",disabled:!r.value.name.trim()},k(u.value?"‰øùÂ≠ò":"ÂàõÂª∫"),9,Zn)])],32)])])]))}},Kn=ue(Yn,[["__scopeId","data-v-55616eec"]]),Qn={class:"playlists-container"},Jn={class:"content-body"},Xn={key:0,class:"playlists-grid"},ei=["onClick"],ti={class:"playlist-cover"},si=["src"],li={class:"playlist-info"},oi={class:"playlist-name"},ai={class:"playlist-count"},ni={class:"playlist-actions"},ii=["onClick"],ri=["onClick"],ci={key:1,class:"empty-state"},di={__name:"PlaylistsManager",props:{playlists:{type:Array,default:()=>[]},getCoverUrl:{type:Function,required:!0}},emits:["create-playlist","update-playlist","delete-playlist","open-playlist"],setup(a,{emit:c}){const n=a,s=c,r=b(!1),i=b(null),o=w=>w.cover?n.getCoverUrl(w.cover):w.songs.length>0&&w.songs[0].cover?n.getCoverUrl(w.songs[0].cover):u(),u=()=>"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjNjY3ZWVhIi8+CjxwYXRoIGQ9Ik0xMDAgNTBDMTI3LjYxNCA1MCA1MCA3Ny4zODU4IDUwIDEwNUM1MCAxMzIuNjE0IDc3LjM4NTggMTYwIDEwNSAxNjBDMTMyLjYxNCAxNjAgMTYwIDEzMi42MTQgMTYwIDEwNUMxNjAgNzcuMzg1OCAxMzIuNjE0IDUwIDEwNSA1MEgxMDBWNTBaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPGNpcmNsZSBjeD0iMTA1IiBjeT0iMTA1IiByPSIyMCIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+Cjwvc3ZnPgo=",f=w=>{s("open-playlist",w)},F=()=>{console.log("ÁÇπÂáªÂàõÂª∫Ê≠åÂçïÊåâÈíÆ"),i.value=null,r.value=!0,console.log("showCreateModalËÆæÁΩÆ‰∏∫:",r.value)},U=w=>{i.value=w,r.value=!0},M=w=>{confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§Ê≠åÂçï "${w.name}" ÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§ç„ÄÇ`)&&s("delete-playlist",w)},h=w=>{i.value?s("update-playlist",{...i.value,...w}):s("create-playlist",w),$()},$=()=>{r.value=!1,i.value=null};return(w,S)=>(d(),g("div",Qn,[e("div",{class:"content-header"},[S[1]||(S[1]=e("h1",null,"ÊàëÁöÑÊ≠åÂçï",-1)),e("div",{class:"header-actions"},[e("button",{class:"create-playlist-btn",onClick:F},S[0]||(S[0]=[e("span",{class:"btn-icon"},"‚ûï",-1),H(" ÂàõÂª∫Ê≠åÂçï ")]))])]),e("div",Jn,[a.playlists.length>0?(d(),g("div",Xn,[(d(!0),g(ce,null,de(a.playlists,T=>(d(),g("div",{key:T.id,class:"playlist-card",onClick:K=>f(T)},[e("div",ti,[e("img",{src:o(T),alt:"Ê≠åÂçïÂ∞ÅÈù¢"},null,8,si),S[2]||(S[2]=e("div",{class:"play-overlay"},[e("div",{class:"play-button"},"‚ñ∂")],-1))]),e("div",li,[e("h3",oi,k(T.name),1),e("p",ai,k(T.songs.length)+" È¶ñÊ≠åÊõ≤",1)]),e("div",ni,[e("button",{onClick:se(K=>U(T),["stop"]),class:"action-btn",title:"ÁºñËæë"},S[3]||(S[3]=[e("span",null,"‚úèÔ∏è",-1)]),8,ii),e("button",{onClick:se(K=>M(T),["stop"]),class:"action-btn delete",title:"Âà†Èô§"},S[4]||(S[4]=[e("span",null,"üóëÔ∏è",-1)]),8,ri)])],8,ei))),128))])):(d(),g("div",ci,[S[6]||(S[6]=e("div",{class:"empty-icon"},"üìã",-1)),S[7]||(S[7]=e("h3",{class:"empty-title"},"ËøòÊ≤°ÊúâÂàõÂª∫‰ªª‰ΩïÊ≠åÂçï",-1)),S[8]||(S[8]=e("p",{class:"empty-description"},"ÂàõÂª∫Ê≠åÂçïÊù•Êï¥ÁêÜÊÇ®ÂñúÊ¨¢ÁöÑÈü≥‰πê",-1)),e("button",{class:"empty-create-btn",onClick:F},S[5]||(S[5]=[e("span",{class:"btn-icon"},"‚ûï",-1),H(" ÂàõÂª∫Á¨¨‰∏Ä‰∏™Ê≠åÂçï ")]))]))]),r.value?(d(),$e(Kn,{key:0,playlist:i.value,onSave:h,onClose:$},null,8,["playlist"])):q("",!0)]))}},ui={class:"playlist-song-grid-container"},vi={class:"list-header"},gi={class:"header-actions"},pi=["disabled"],yi=["disabled"],hi=["disabled"],mi={key:0,class:"song-grid"},fi=["onClick","onContextmenu"],bi={class:"cover-container"},wi=["src"],ki={class:"song-info"},$i={class:"song-title"},Ci={class:"song-artist"},Si={key:1,class:"empty-state"},Ii={__name:"PlaylistSongGrid",props:{playlist:{type:Array,default:()=>[]},currentSong:Object,isPlaying:Boolean,getCoverUrl:Function,playlists:{type:Array,default:()=>[]}},emits:["play-song","delete-song","add-to-playlist","play-order","play-loop","shuffle-play"],setup(a,{emit:c}){const n=a,s=c,r=b({visible:!1,position:{x:0,y:0},song:null}),i=w=>{s("play-song",w)},o=(w,S)=>{r.value={visible:!0,position:{x:w.clientX,y:w.clientY},song:S}},u=()=>{r.value.visible=!1},f=w=>{s("delete-song",w),u()},F=(w,S)=>{s("add-to-playlist",w,S),u()},U=()=>{s("play-order",[...n.playlist])},M=()=>{s("play-loop",[...n.playlist])},h=()=>{s("shuffle-play",[...n.playlist])},$=()=>{r.value.visible&&u()};return We(()=>{document.addEventListener("click",$)}),pt(()=>{document.removeEventListener("click",$)}),(w,S)=>(d(),g("div",ui,[e("div",vi,[S[3]||(S[3]=e("h3",null,"Èü≥‰πêÂ∫ì",-1)),e("div",gi,[e("button",{class:"play-order-btn",onClick:U,disabled:a.playlist.length===0},S[0]||(S[0]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M8 5v14l11-7z"})],-1),H(" È°∫Â∫èÊí≠Êîæ ")]),8,pi),e("button",{class:"play-loop-btn",onClick:M,disabled:a.playlist.length===0},S[1]||(S[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"})],-1),H(" Âæ™ÁéØÊí≠Êîæ ")]),8,yi),e("button",{class:"shuffle-btn",onClick:h,disabled:a.playlist.length===0},S[2]||(S[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"})],-1),H(" ÈöèÊú∫Êí≠Êîæ ")]),8,hi)])]),a.playlist.length>0?(d(),g("div",mi,[(d(!0),g(ce,null,de(a.playlist,T=>(d(),g("div",{key:T.id,class:G(["song-card",{playing:a.currentSong&&a.currentSong.id===T.id&&a.isPlaying,"is-favorite":T.isFavorite}]),onClick:K=>i(T),onContextmenu:se(K=>o(K,T),["prevent"])},[e("div",bi,[e("img",{src:a.getCoverUrl(T.cover),class:G(["cover",{"cd-spinning":a.currentSong?.id===T.id&&a.isPlaying,"cd-round":a.currentSong?.id===T.id&&a.isPlaying}])},null,10,wi),e("div",{class:G(["play-overlay",{hidden:a.currentSong?.id===T.id&&a.isPlaying}])},S[4]||(S[4]=[e("div",{class:"play-button"},"‚ñ∂",-1)]),2)]),e("div",ki,[e("h4",$i,k(T.title),1),e("p",Ci,k(T.artist),1)])],42,fi))),128))])):(d(),g("div",Si,S[5]||(S[5]=[e("div",{class:"empty-icon"},"üéµ",-1),e("p",null,"ÊöÇÊó†Ê≠åÊõ≤",-1)]))),Te(xt,{visible:r.value.visible,position:r.value.position,song:r.value.song,playlists:a.playlists,onDeleteSong:f,onAddToPlaylist:F,onClose:u},null,8,["visible","position","song","playlists"])]))}},Mi=ue(Ii,[["__scopeId","data-v-f46c7606"]]),xi={class:"draggable-song-list"},_i={class:"list-header"},Pi={class:"header-actions"},Li=["disabled"],Di=["disabled"],Ai=["disabled"],Ui={class:"song-list-container"},Ti={key:0,class:"empty-state"},Fi={key:1,class:"song-items-wrapper"},zi={class:"song-items"},Ni=["onDragstart","onDragover","onDragenter","onDrop","onClick"],ji={class:"song-number"},Bi={class:"song-cover"},Ri=["src","alt"],Ei={key:0,class:"play-indicator"},Oi={class:"song-info"},qi={class:"song-title"},Vi={class:"song-artist"},Hi={key:0,class:"song-duration"},Gi={class:"song-actions"},Wi=["onClick","title"],Zi={__name:"DraggableSongList",props:{songs:{type:Array,default:()=>[]},currentSong:Object,isPlaying:Boolean,getCoverUrl:Function},emits:["play-song","toggle-favorite","remove-song","update-order","play-order","play-loop","shuffle-play"],setup(a,{emit:c}){const n=a,s=c,r=b(-1),i=b(-1),o=b(null);b({x:0,y:0});const u=b([]);Ge(()=>n.songs,p=>{u.value=[...p]},{immediate:!0});const f=(p,x)=>{r.value=p,o.value=x.target.closest(".song-item"),x.dataTransfer.effectAllowed="move",x.dataTransfer.setData("text/plain",""),setTimeout(()=>{o.value&&o.value.classList.add("dragging")},0)},F=(p,x)=>{x.preventDefault(),x.dataTransfer.dropEffect="move",r.value!==-1&&r.value!==p&&(i.value=p)},U=p=>{r.value!==-1&&r.value!==p&&(i.value=p)},M=()=>{i.value=-1},h=(p,x)=>{if(x.preventDefault(),r.value!==-1&&r.value!==p){const D=[...u.value],B=D[r.value];D.splice(r.value,1),D.splice(p,0,B),u.value=D,s("update-order",D)}w()},$=p=>{w()},w=()=>{o.value&&o.value.classList.remove("dragging"),r.value=-1,i.value=-1,o.value=null},S=p=>{s("play-song",p)},T=p=>{s("toggle-favorite",p)},K=()=>{s("play-order",[...u.value])},O=()=>{s("play-loop",[...u.value])},N=()=>{s("shuffle-play",[...u.value])};return(p,x)=>(d(),g("div",xi,[e("div",_i,[x[3]||(x[3]=e("h3",null,"Êí≠ÊîæÈ°∫Â∫è",-1)),e("div",Pi,[e("button",{class:"play-order-btn",onClick:K,disabled:a.songs.length===0},x[0]||(x[0]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M8 5v14l11-7z"})],-1),H(" È°∫Â∫èÊí≠Êîæ ")]),8,Li),e("button",{class:"play-loop-btn",onClick:O,disabled:a.songs.length===0},x[1]||(x[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"})],-1),H(" Âæ™ÁéØÊí≠Êîæ ")]),8,Di),e("button",{class:"shuffle-btn",onClick:N,disabled:a.songs.length===0},x[2]||(x[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"})],-1),H(" ÈöèÊú∫Êí≠Êîæ ")]),8,Ai)])]),e("div",Ui,[u.value.length===0?(d(),g("div",Ti,x[4]||(x[4]=[e("div",{class:"empty-icon"},"üéµ",-1),e("p",null,"Ê≠åÂçï‰∏≠ËøòÊ≤°ÊúâÊ≠åÊõ≤",-1)]))):(d(),g("div",Fi,[e("div",zi,[(d(!0),g(ce,null,de(u.value,(D,B)=>(d(),g("div",{key:D.id,class:G(["song-item",{active:a.currentSong?.id===D.id,playing:a.currentSong?.id===D.id&&a.isPlaying,dragging:r.value===B,"drag-over":i.value===B&&r.value!==B}]),draggable:"true",onDragstart:W=>f(B,W),onDragover:se(W=>F(B,W),["prevent"]),onDragenter:se(W=>U(B),["prevent"]),onDragleave:M,onDrop:se(W=>h(B,W),["prevent"]),onDragend:$,onClick:W=>S(D)},[x[6]||(x[6]=e("div",{class:"drag-handle",title:"ÊãñÊãΩÊéíÂ∫è"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})])],-1)),e("div",ji,k(B+1),1),e("div",Bi,[e("img",{src:a.getCoverUrl(D.cover),alt:D.title},null,8,Ri),a.currentSong?.id===D.id&&a.isPlaying?(d(),g("div",Ei,x[5]||(x[5]=[e("div",{class:"playing-animation"},[e("span"),e("span"),e("span")],-1)]))):q("",!0)]),e("div",Oi,[e("div",qi,k(D.title),1),e("div",Vi,k(D.artist),1)]),D.duration?(d(),g("div",Hi,k(D.duration),1)):q("",!0),e("div",Gi,[e("button",{class:"action-btn",onClick:se(W=>T(D),["stop"]),title:D.isFavorite?"ÂèñÊ∂àÊî∂Ëóè":"Êî∂Ëóè"},[e("span",{class:G(["heart-icon",{filled:D.isFavorite}])},k(D.isFavorite?"‚ô•":"‚ô°"),3)],8,Wi)])],42,Ni))),128))])]))])]))}},Yi=ue(Zi,[["__scopeId","data-v-fc10e74f"]]),Ki={class:"playlist-detail-container"},Qi={class:"playlist-header"},Ji={class:"playlist-cover"},Xi=["src"],er={class:"playlist-info"},tr={class:"playlist-title"},sr={key:0,class:"playlist-description"},lr={class:"playlist-stats"},or={class:"song-count"},ar={class:"created-date"},nr={class:"playlist-content"},ir={key:0,class:"songs-section"},rr={class:"playlist-controls"},cr={class:"view-toggle"},dr={key:1,class:"empty-state"},ur={__name:"PlaylistDetail",props:{playlist:{type:Object,required:!0},currentSong:Object,isPlaying:Boolean,getCoverUrl:Function,playlists:{type:Array,default:()=>[]},playMode:{type:String,default:"order"}},emits:["play-song","toggle-favorite","remove-song","edit-playlist","go-back","navigate","play-order","play-loop","shuffle-play","toggle-loop","update-song-order","add-to-playlist"],setup(a,{emit:c}){const n=b("grid"),s=a,r=c,i=()=>s.playlist.cover?s.getCoverUrl(s.playlist.cover):s.playlist.songs.length>0&&s.playlist.songs[0].cover?s.getCoverUrl(s.playlist.songs[0].cover):o(),o=()=>"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjNjY3ZWVhIi8+CjxwYXRoIGQ9Ik0xMDAgNTBDMTI3LjYxNCA1MCA1MCA3Ny4zODU4IDUwIDEwNUM1MCAxMzIuNjE0IDc3LjM4NTggMTYwIDEwNSAxNjBDMTMyLjYxNCAxNjAgMTYwIDEzMi42MTQgMTYwIDEwNUMxNjAgNzcuMzg1OCAxMzIuNjE0IDUwIDEwNSA1MEgxMDBWNTBaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPGNpcmNsZSBjeD0iMTA1IiBjeT0iMTA1IiByPSIyMCIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGQ9Ik0xMDAgODBMMTIwIDEwMEwxMDAgMTIwVjgwWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+",u=O=>new Date(O).toLocaleDateString("zh-CN"),f=O=>{r("play-song",O)},F=O=>{r("toggle-favorite",O)},U=(O,N)=>{r("add-to-playlist",O,N)},M=O=>{confirm(`Á°ÆÂÆöË¶Å‰ªéÊ≠åÂçï‰∏≠ÁßªÈô§ "${O.title}" ÂêóÔºü`)&&r("remove-song",O)},h=()=>{r("edit-playlist",s.playlist)},$=()=>{r("go-back")},w=O=>{r("update-song-order",O)},S=O=>{r("play-order",O)},T=O=>{r("play-loop",O)},K=O=>{r("shuffle-play",O)};return(O,N)=>(d(),g("div",Ki,[e("div",Qi,[e("div",Ji,[e("img",{src:i(),alt:"Ê≠åÂçïÂ∞ÅÈù¢"},null,8,Xi)]),e("div",er,[N[5]||(N[5]=e("div",{class:"playlist-meta"},[e("span",{class:"playlist-type"},"Ê≠åÂçï")],-1)),e("h1",tr,k(a.playlist.name),1),a.playlist.description?(d(),g("p",sr,k(a.playlist.description),1)):q("",!0),e("div",lr,[e("span",or,k(a.playlist.songs.length)+" È¶ñÊ≠åÊõ≤",1),e("span",ar,"ÂàõÂª∫‰∫é "+k(u(a.playlist.createdAt)),1)]),e("div",{class:"playlist-actions"},[e("button",{class:"edit-btn",onClick:h},N[3]||(N[3]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})],-1),H(" ÁºñËæë ")])),e("button",{class:"back-btn",onClick:$},N[4]||(N[4]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})],-1),H(" ËøîÂõû ")]))])])]),e("div",nr,[a.playlist.songs.length>0?(d(),g("div",ir,[e("div",rr,[e("div",cr,[e("button",{class:G(["toggle-btn",{active:n.value==="grid"}]),onClick:N[0]||(N[0]=p=>n.value="grid")},N[6]||(N[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 11h5V5H4v6zm0 7h5v-6H4v6zm6 0h5v-6h-5v6zm6 0h5v-6h-5v6zm-6-7h5V5h-5v6zm6-6v6h5V5h-5z"})],-1),H(" ÁΩëÊ†ºËßÜÂõæ ")]),2),e("button",{class:G(["toggle-btn",{active:n.value==="list"}]),onClick:N[1]||(N[1]=p=>n.value="list")},N[7]||(N[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 14h4v-4H4v4zm0 5h4v-4H4v4zM4 9h4V5H4v4zm5 5h12v-4H9v4zm0 5h12v-4H9v4zM9 5v4h12V5H9z"})],-1),H(" ÂàóË°®ËßÜÂõæ ")]),2)])]),n.value==="grid"?(d(),$e(Mi,{key:0,playlist:a.playlist.songs,"current-song":a.currentSong,"is-playing":a.isPlaying,"get-cover-url":a.getCoverUrl,playlists:a.playlists,onPlaySong:f,onDeleteSong:M,onAddToPlaylist:U,onPlayOrder:S,onPlayLoop:T,onShufflePlay:K},null,8,["playlist","current-song","is-playing","get-cover-url","playlists"])):(d(),$e(Yi,{key:1,songs:a.playlist.songs,"current-song":a.currentSong,"is-playing":a.isPlaying,"get-cover-url":a.getCoverUrl,onPlaySong:f,onToggleFavorite:F,onRemoveSong:M,onUpdateOrder:w,onPlayOrder:S,onPlayLoop:T,onShufflePlay:K},null,8,["songs","current-song","is-playing","get-cover-url"]))])):(d(),g("div",dr,[N[9]||(N[9]=e("div",{class:"empty-icon"},"üéµ",-1)),N[10]||(N[10]=e("h3",{class:"empty-title"},"Ê≠åÂçïËøòÊ≤°ÊúâÊ≠åÊõ≤",-1)),N[11]||(N[11]=e("p",{class:"empty-description"},"ÈÄöËøáÂè≥ÈîÆËèúÂçïÂ∞ÜÊ≠åÊõ≤Ê∑ªÂä†Âà∞Ëøô‰∏™Ê≠åÂçï",-1)),e("button",{class:"back-to-library-btn",onClick:N[2]||(N[2]=p=>O.$emit("navigate","library"))},N[8]||(N[8]=[e("span",{class:"btn-icon"},"üé∂",-1),H(" ÂéªÊ∑ªÂä†Ê≠åÊõ≤ ")]))]))])]))}},vr={class:"settings-header"},gr={class:"settings-content"},pr={class:"setting-section"},yr={class:"setting-item"},hr={class:"setting-control"},mr={class:"theme-selector"},fr={class:"setting-section"},br={class:"setting-item"},wr={class:"setting-control"},kr={class:"storage-info"},$r={class:"storage-item"},Cr={class:"storage-value"},Sr={class:"storage-item"},Ir={class:"storage-value"},Mr={class:"setting-section"},xr={class:"setting-item"},_r={class:"setting-control"},Pr={class:"app-info"},Lr={class:"info-item"},Dr={__name:"UserSettings",props:{isDarkMode:{type:Boolean,default:!1}},emits:["close","theme-changed"],setup(a,{emit:c}){const n=c,s=a,r=Ce(()=>s.isDarkMode?"Ê∑±Ëâ≤‰∏ªÈ¢ò":"ÊµÖËâ≤‰∏ªÈ¢ò"),i=b(3),o=b(new Date().toLocaleDateString("zh-CN")),u=async M=>{try{await V.saveTheme(M),n("theme-changed",M),console.log(`‰∏ªÈ¢òÂ∑≤ÂàáÊç¢‰∏∫: ${M?"Ê∑±Ëâ≤":"ÊµÖËâ≤"}`)}catch(h){console.error("‰øùÂ≠ò‰∏ªÈ¢òËÆæÁΩÆÂ§±Ë¥•:",h)}},f=async()=>{if(confirm("Á°ÆÂÆöË¶ÅÈáçÁΩÆÊâÄÊúâËÆæÁΩÆÂêóÔºüËøôÂ∞ÜÊ∏ÖÈô§ÊâÄÊúâÁî®Êà∑ÂÅèÂ•ΩËÆæÁΩÆ„ÄÇ"))try{await V.deleteSetting("theme"),await V.saveTheme(!1),n("theme-changed",!1),alert("ËÆæÁΩÆÂ∑≤ÈáçÁΩÆ‰∏∫ÈªòËÆ§ÂÄº"),console.log("Áî®Êà∑ËÆæÁΩÆÂ∑≤ÈáçÁΩÆ")}catch(M){console.error("ÈáçÁΩÆËÆæÁΩÆÂ§±Ë¥•:",M),alert("ÈáçÁΩÆËÆæÁΩÆÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï")}},F=()=>{n("close")},U=M=>{M.target===M.currentTarget&&n("close")};return We(()=>{console.log("Áî®Êà∑ËÆæÁΩÆÁªÑ‰ª∂Â∑≤Âä†ËΩΩ")}),(M,h)=>(d(),g("div",{class:"settings-modal-overlay",onClick:U},[e("div",{class:"settings-modal",onClick:h[3]||(h[3]=se(()=>{},["stop"]))},[e("div",vr,[h[5]||(h[5]=e("h2",null,"Áî®Êà∑ËÆæÁΩÆ",-1)),e("button",{class:"close-btn",onClick:h[0]||(h[0]=$=>M.$emit("close")),title:"ÂÖ≥Èó≠"},h[4]||(h[4]=[e("span",null,"√ó",-1)]))]),e("div",gr,[e("div",pr,[h[9]||(h[9]=e("div",{class:"section-header"},[e("h3",null,"üé® ‰∏ªÈ¢òËÆæÁΩÆ")],-1)),e("div",yr,[h[8]||(h[8]=e("div",{class:"setting-info"},[e("div",{class:"setting-label"},"‰∏ªÈ¢òÊ®°Âºè"),e("div",{class:"setting-description"},"ÈÄâÊã©ÊÇ®ÂñúÊ¨¢ÁöÑÁïåÈù¢‰∏ªÈ¢ò")],-1)),e("div",hr,[e("div",mr,[e("button",{class:G(["theme-option",{active:!a.isDarkMode}]),onClick:h[1]||(h[1]=$=>u(!1))},h[6]||(h[6]=[e("span",{class:"theme-icon"},"‚òÄÔ∏è",-1),e("span",{class:"theme-name"},"ÊµÖËâ≤",-1)]),2),e("button",{class:G(["theme-option",{active:a.isDarkMode}]),onClick:h[2]||(h[2]=$=>u(!0))},h[7]||(h[7]=[e("span",{class:"theme-icon"},"üåô",-1),e("span",{class:"theme-name"},"Ê∑±Ëâ≤",-1)]),2)])])])]),e("div",fr,[h[16]||(h[16]=e("div",{class:"section-header"},[e("h3",null,"üíæ Êï∞ÊçÆÁÆ°ÁêÜ")],-1)),e("div",br,[h[13]||(h[13]=e("div",{class:"setting-info"},[e("div",{class:"setting-label"},"Â≠òÂÇ®‰ø°ÊÅØ"),e("div",{class:"setting-description"},"Êü•ÁúãÂ∫îÁî®Êï∞ÊçÆÂ≠òÂÇ®ÊÉÖÂÜµ")],-1)),e("div",wr,[e("div",kr,[e("div",$r,[h[10]||(h[10]=e("span",{class:"storage-label"},"‰∏ªÈ¢òËÆæÁΩÆ:",-1)),e("span",Cr,k(r.value),1)]),e("div",Sr,[h[11]||(h[11]=e("span",{class:"storage-label"},"Êï∞ÊçÆÂ∫ìÁâàÊú¨:",-1)),e("span",Ir,"v"+k(i.value),1)]),h[12]||(h[12]=e("div",{class:"storage-item"},[e("span",{class:"storage-label"},"Â≠òÂÇ®‰ΩçÁΩÆ:"),e("span",{class:"storage-value"},"IndexedDB")],-1))])])]),e("div",{class:"setting-item"},[h[15]||(h[15]=e("div",{class:"setting-info"},[e("div",{class:"setting-label"},"ÈáçÁΩÆËÆæÁΩÆ"),e("div",{class:"setting-description"},"Ê∏ÖÈô§ÊâÄÊúâÁî®Êà∑ËÆæÁΩÆÔºåÊÅ¢Â§çÈªòËÆ§Áä∂ÊÄÅ")],-1)),e("div",{class:"setting-control"},[e("button",{class:"reset-btn",onClick:f},h[14]||(h[14]=[e("span",{class:"btn-icon"},"üîÑ",-1),H(" ÈáçÁΩÆÊâÄÊúâËÆæÁΩÆ ")]))])])]),e("div",Mr,[h[19]||(h[19]=e("div",{class:"section-header"},[e("h3",null,"‚ÑπÔ∏è ÂÖ≥‰∫é")],-1)),e("div",xr,[h[18]||(h[18]=e("div",{class:"setting-info"},[e("div",{class:"setting-label"},"Èü≥‰πêÊí≠ÊîæÂô®"),e("div",{class:"setting-description"},"Âü∫‰∫é Vue 3 ÊûÑÂª∫ÁöÑÁé∞‰ª£Èü≥‰πêÊí≠ÊîæÂô®")],-1)),e("div",_r,[e("div",Pr,[h[17]||(h[17]=e("div",{class:"info-item"},"ÁâàÊú¨: 1.0.0",-1)),e("div",Lr,"ÊûÑÂª∫Êó∂Èó¥: "+k(o.value),1)])])])])]),e("div",{class:"settings-footer"},[e("button",{class:"save-btn",onClick:F},h[20]||(h[20]=[e("span",{class:"btn-icon"},"üíæ",-1),H(" ‰øùÂ≠òÂπ∂ÂÖ≥Èó≠ ")]))])])]))}},Ar=ue(Dr,[["__scopeId","data-v-952e9cf7"]]),Ur={class:"app"},Tr={key:0,class:"library-view"},Fr={class:"content-header"},zr={class:"header-actions"},Nr={class:"content-body"},jr={key:1,class:"empty-state"},Br={key:1,class:"favorites-view"},Rr={key:2,class:"playlists-view"},Er={key:3,class:"playlist-detail-view"},Or={key:4,class:"netease-online-view"},qr={class:"content-body"},Vr={key:5,class:"recent-view"},Hr={class:"content-body"},Gr={key:1,class:"empty-state"},Wr={key:6,class:"other-view"},Zr={class:"content-header"},Yr={class:"player-main"},Kr={class:"cd-area"},Qr={class:"cd-container"},Jr=["src","alt"],Xr={class:"song-info"},ec={class:"song-title"},tc={class:"song-artist"},sc={class:"lyrics-area"},lc=["data-lyric-index","onClick"],oc={key:1,class:"no-lyrics"},ac={class:"fullscreen-controls"},nc={class:"control-bar"},ic={class:"song-display"},rc=["src"],cc={class:"song-details"},dc={class:"control-title"},uc={class:"control-artist"},vc={width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},gc=["fill"],pc={class:"playback-controls"},yc=["title"],hc={key:0,width:"28",height:"28",viewBox:"0 0 24 24",fill:"none"},mc={key:1,width:"28",height:"28",viewBox:"0 0 24 24",fill:"none"},fc={class:"progress-section"},bc={class:"time-display"},wc={class:"time-display"},kc={class:"volume-section"},$c={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},Cc={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},Sc={key:2,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},Ic={class:"mini-player-info"},Mc=["src"],xc={class:"mini-details"},_c={class:"mini-title"},Pc={class:"mini-artist"},Lc={class:"mini-controls"},Dc={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},Ac={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},ut="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjNjY3ZWVhIi8+CjxwYXRoIGQ9Ik0xMDAgNTBDMTI3LjYxNCA1MCA1MCA3Ny4zODU4IDUwIDEwNUM1MCAxMzIuNjE0IDc3LjM4NTggMTYwIDEwNSAxNjBDMTMyLjYxNCAxNjAgMTYwIDEzMi42MTQgMTYwIDEwNUMxNjAgNzcuMzg1OCAxMzIuNjE0IDUwIDEwNSA1MEgxMDBWNTBaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPGNpcmNsZSBjeD0iMTA1IiBjeT0iMTA1IiByPSIyMCIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+Cjwvc3ZnPgo=",St="musicplayer_playlist",It="musicplayer_playlists",Tc={__name:"App",setup(a){const c=b([]),n=b([]),s=b(null),r=b("order"),i=b(null),o=b([]),u=b([]),f=b(new Map),F=b(!1),U=b(!1),M=b(!1),h=b(!1),$=b(!1),w=b(!1),S=b(null),{isDarkMode:T,toggleTheme:K,loadTheme:O}=sn();O().catch(t=>{console.error("Âä†ËΩΩ‰∏ªÈ¢òËÆæÁΩÆÂ§±Ë¥•:",t)});const N=async t=>{try{T.value=t,await V.saveTheme(t),console.log(`‰∏ªÈ¢òÂ∑≤Êõ¥Êñ∞‰∏∫: ${t?"Ê∑±Ëâ≤":"ÊµÖËâ≤"}`)}catch(l){console.error("Êõ¥Êñ∞‰∏ªÈ¢òÂ§±Ë¥•:",l)}},p=b(null),x=b(!1),D=b(0),B=b(0),W=b(80),z=b(null),Se=b(!0),ve=b(!1),Ie=b(!1),je=b(!1),oe=b(!1),Ze=b(80),Le=b(1),Me=b([]),Je=b(!1),ie=b("library"),Ye=b(""),Be=b([]),Re=b(!1),st=Ce(()=>c.value.filter(t=>t.isFavorite)),Ee=async t=>{if(t&&(t.startsWith("uploaded_")||t.startsWith("netease_")))try{const l=await V.getFile("songs",t);return console.log("‰ªéIndexedDBËé∑ÂèñÊ≠åÊõ≤URL:",t,"->",l),l||new URL(Object.assign({})[`/src/assets/music/songs/${t}`],import.meta.url).href}catch(l){return console.error("Ëé∑ÂèñÊ≠åÊõ≤Êñá‰ª∂Â§±Ë¥•:",l),new URL(Object.assign({})[`/src/assets/music/songs/${t}`],import.meta.url).href}return new URL(Object.assign({})[`/src/assets/music/songs/${t}`],import.meta.url).href},P=b(new Map),I=(t,l=null)=>{if(!t&&!l)return ut;if(l&&(l.startsWith("http://")||l.startsWith("https://")))return l;if(t&&t.startsWith("data:")||t&&(t.startsWith("http://")||t.startsWith("https://")))return t;if(t&&(t.startsWith("uploaded_")||t.startsWith("downloaded_")||t.startsWith("netease_")))return P.value.has(t)?P.value.get(t):(L(t),ut);try{return new URL(Object.assign({})[`/src/assets/music/covers/${t}`],import.meta.url).href}catch(y){return console.error("Ëé∑ÂèñassetsÂ∞ÅÈù¢Â§±Ë¥•:",y),ut}},L=async t=>{try{await V.init();const l=await V.getFile("covers",t);l&&P.value.set(t,l)}catch(l){console.error("Âä†ËΩΩÂ∞ÅÈù¢URLÂ§±Ë¥•:",l)}},A=async t=>{if(p.value&&p.value.id===t.id&&x.value){x.value=!1,Se.value=!1,ve.value=!1,z.value&&z.value.pause();return}z.value&&(z.value.pause(),z.value.currentTime=0),p.value=t,x.value=!0,Se.value=!0,ve.value=!0,z.value||(z.value=new Audio,z.value.addEventListener("timeupdate",we),z.value.addEventListener("loadedmetadata",Ae),z.value.addEventListener("ended",be));try{const l=await Ee(t.song);console.log("Êí≠ÊîæÊ≠åÊõ≤:",t.title,"- URL:",l),z.value.src=l,z.value.volume=W.value/100,z.value.playbackRate=Le.value,D.value=0,B.value=0,await z.value.play()}catch(l){console.error("Êí≠ÊîæÂ§±Ë¥•:",l,"Ê≠åÊõ≤:",t.title),x.value=!1}},R=()=>{if(!z.value||!p.value){console.warn("Èü≥È¢ëÂÖÉÁ¥†ÊàñÂΩìÂâçÊ≠åÊõ≤‰∏çÂ≠òÂú®");return}x.value=!x.value,x.value?z.value.play().catch(t=>{console.error("Êí≠ÊîæÂ§±Ë¥•:",t),x.value=!1}):z.value.pause()},J=()=>{if(i.value&&o.value.length>0){const y=o.value.findIndex(C=>C.id===p.value?.id);if(y!==-1){const C=(y+1)%o.value.length;A(o.value[C]);return}}const l=(c.value.findIndex(y=>y.id===p.value?.id)+1)%c.value.length;A(c.value[l])},ae=()=>{if(i.value&&o.value.length>0){const y=o.value.findIndex(C=>C.id===p.value?.id);if(y!==-1){const C=(y-1+o.value.length)%o.value.length;A(o.value[C]);return}}const l=(c.value.findIndex(y=>y.id===p.value?.id)-1+c.value.length)%c.value.length;A(c.value[l])},Z=t=>{if(!z.value||!B.value||isNaN(B.value)||B.value<=0)return;const y=Math.max(0,Math.min(1,t))*B.value;if(y>=0&&y<=B.value)try{z.value.currentTime=y}catch(C){console.error("Ë∑≥ËΩ¨Â§±Ë¥•:",C)}},ee=t=>{if(!z.value||!B.value||isNaN(B.value)||B.value<=0)return;const l=Math.max(0,Math.min(B.value,t));try{z.value.currentTime=l}catch(y){console.error("Êó∂Èó¥Ë∑≥ËΩ¨Â§±Ë¥•:",y)}},m=t=>{W.value=t,z.value.volume=t/100},v=t=>{Le.value=t,z.value&&(z.value.playbackRate=t)},_=t=>{if(Ye.value=t,!t.trim()){Be.value=[],Re.value=!1;return}Re.value=!0;const l=t.toLowerCase(),y=[...c.value];n.value.forEach(E=>{y.push(...E.songs)});const C=y.filter((E,le,pe)=>le===pe.findIndex(ke=>ke.id===E.id));Be.value=C.filter(E=>E.title.toLowerCase().includes(l)||E.artist.toLowerCase().includes(l)||E.album&&E.album.toLowerCase().includes(l))},X=()=>{Ye.value="",Be.value=[],Re.value=!1},me=async t=>{try{console.log("ÁΩëÊòì‰∫ëÈü≥‰πêÂØºÂÖ•ÂÆåÊàê:",t.length,"È¶ñÊ≠åÊõ≤");let l=0;for(const y of t)try{console.log("Â§ÑÁêÜÊ≠åÊõ≤Êï∞ÊçÆ:",y);const C={id:parseInt(y.id,36),title:y.title,artist:y.artist,album:y.album||"",duration:y.duration||0,song:y.audioFile,cover:y.coverFile,coverUrl:y.coverUrl,lrcFile:y.lrcFile,isUploaded:!0,isFavorite:!1,source:"netease",sourceId:y.sourceId};console.log("ÂàõÂª∫ÁöÑÊ≠åÊõ≤ÂØπË±°:",C),c.value.push(C),C.cover&&L(C.cover),l++}catch(C){console.error("ÂØºÂÖ•Ê≠åÊõ≤Â§±Ë¥•:",y.title,C)}Xe(),j(`ÊàêÂäüÂØºÂÖ• ${l} È¶ñÊ≠åÊõ≤Âà∞Èü≥‰πêÂ∫ì`),console.log("ÁΩëÊòì‰∫ëÈü≥‰πêÂØºÂÖ•ÂÆåÊàêÔºåÊàêÂäü:",l,"È¶ñ")}catch(l){console.error("ÂØºÂÖ•ÁΩëÊòì‰∫ëÈü≥‰πêÂ§±Ë¥•:",l),j("ÂØºÂÖ•ÁΩëÊòì‰∫ëÈü≥‰πêÂ§±Ë¥•")}},j=t=>{const l=document.createElement("div");l.textContent=t,l.style.cssText=`
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--color-primary);
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 10000;
    font-size: 14px;
    font-weight: 500;
  `,document.body.appendChild(l),setTimeout(()=>{l.parentNode&&l.parentNode.removeChild(l)},3e3)},Oe=t=>t?t.isFavorite===!0:!1,re=(t=null)=>{const l=t||p.value;if(l){const y=c.value.findIndex(C=>C.id===l.id);y!==-1&&(c.value[y].isFavorite=!c.value[y].isFavorite,p.value&&p.value.id===l.id&&(p.value.isFavorite=c.value[y].isFavorite),Xe())}},xe=()=>{Ie.value=!Ie.value,console.log("ÈöèÊú∫Êí≠ÊîæÊ®°Âºè:",Ie.value?"ÂºÄÂêØ":"ÂÖ≥Èó≠")},Ke=()=>{je.value=!je.value,console.log("Âæ™ÁéØÊí≠ÊîæÊ®°Âºè:",je.value?"ÂºÄÂêØ":"ÂÖ≥Èó≠")},De=()=>{ve.value=!ve.value},fe=()=>{oe.value?(W.value=Ze.value,z.value.volume=W.value/100,oe.value=!1):(Ze.value=W.value,W.value=0,z.value.volume=0,oe.value=!0)},we=()=>{z.value&&!isNaN(z.value.currentTime)&&(D.value=z.value.currentTime)},Ae=()=>{z.value&&!isNaN(z.value.duration)&&z.value.duration>0&&(B.value=z.value.duration)},be=()=>{if(i.value&&o.value.length>0){const t=o.value.findIndex(l=>l.id===p.value?.id);if(t!==-1){if(r.value==="order"){t<o.value.length-1?A(o.value[t+1]):(x.value=!1,console.log("È°∫Â∫èÊí≠ÊîæÂÆåÊàêÔºåÂÅúÊ≠¢Êí≠Êîæ"));return}else if(r.value==="loop"){const l=(t+1)%o.value.length;A(o.value[l]);return}else if(r.value==="shuffle"){if(t<o.value.length-1)A(o.value[t+1]);else{const l=[...u.value].sort(()=>Math.random()-.5);o.value=l,A(l[0]),console.log("ÈöèÊú∫Êí≠ÊîæÂÆåÊàê‰∏ÄËΩÆÔºåÈáçÊñ∞ÈöèÊú∫ÊéíÂ∫è")}return}}}if(r.value==="order"){const t=c.value.findIndex(l=>l.id===p.value?.id);t!==-1&&t<c.value.length-1?A(c.value[t+1]):x.value=!1}else J()},Q=()=>{Se.value=!0,ve.value=!0},Y=async t=>{if(confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§Ê≠åÊõ≤ "${t.title}" ÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§ç„ÄÇ`))try{await Gt(t)}catch{alert("Âà†Èô§Ê≠åÊõ≤Â§±Ë¥•ÔºåËØ∑ÈáçËØï")}},ge=t=>{S.value={...t},M.value=!0},lt=t=>{const l=c.value.findIndex(y=>y.id===t.id);if(l!==-1&&(c.value[l]=t),n.value.forEach(y=>{const C=y.songs.findIndex(E=>E.id===t.id);C!==-1&&(y.songs[C]={...t},console.log(`Êõ¥Êñ∞Ê≠åÂçï "${y.name}" ‰∏≠ÁöÑÊ≠åÊõ≤ "${t.title}"`))}),p.value&&p.value.id===t.id&&(p.value=t),i.value){const y=o.value.findIndex(E=>E.id===t.id);y!==-1&&(o.value[y]={...t});const C=u.value.findIndex(E=>E.id===t.id);C!==-1&&(u.value[C]={...t})}Xe(),qe(),M.value=!1,S.value=null,console.log("Ê≠åÊõ≤‰ø°ÊÅØÂ∑≤Êõ¥Êñ∞:",t.title)},at=t=>{const l={id:ne(),...t,songs:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};n.value.push(l),qe(),console.log("Ê≠åÂçïÂàõÂª∫ÊàêÂäü:",l.name)},Pt=t=>{const l=n.value.findIndex(y=>y.id===t.id);l!==-1&&(n.value[l]={...t,updatedAt:new Date().toISOString()},qe(),console.log("Ê≠åÂçïÊõ¥Êñ∞ÊàêÂäü:",t.name))},Lt=t=>{const l=n.value.findIndex(y=>y.id===t.id);l!==-1&&(n.value.splice(l,1),qe(),console.log("Ê≠åÂçïÂà†Èô§ÊàêÂäü:",t.name))},Dt=t=>{s.value=t,ie.value="playlist-detail"},At=()=>{s.value=null,ie.value="playlists"},Ut=t=>{console.log("ÁºñËæëÊ≠åÂçï:",t.name)},qe=()=>{try{localStorage.setItem(It,JSON.stringify(n.value))}catch(t){console.error("‰øùÂ≠òÊ≠åÂçïÂ§±Ë¥•:",t)}},Tt=()=>{try{const t=localStorage.getItem(It);t&&(n.value=JSON.parse(t))}catch(t){console.error("Âä†ËΩΩÊ≠åÂçïÂ§±Ë¥•:",t),n.value=[]}},nt=(t,l)=>{if(l.songs.some(E=>E.id===t.id)){alert(`Ê≠åÊõ≤ "${t.title}" Â∑≤ÁªèÂú®Ê≠åÂçï "${l.name}" ‰∏≠‰∫Ü`);return}const C=n.value.findIndex(E=>E.id===l.id);C!==-1&&(n.value[C].songs.push(t),n.value[C].updatedAt=new Date().toISOString(),qe(),console.log(`Ê≠åÊõ≤ "${t.title}" Â∑≤Ê∑ªÂä†Âà∞Ê≠åÂçï "${l.name}"`),alert(`Ê≠åÊõ≤ "${t.title}" Â∑≤ÊàêÂäüÊ∑ªÂä†Âà∞Ê≠åÂçï "${l.name}"`))},Ft=t=>{if(s.value){const l=s.value.songs.findIndex(y=>y.id===t.id);if(l!==-1){s.value.songs.splice(l,1);const y=n.value.findIndex(C=>C.id===s.value.id);y!==-1&&(n.value[y]={...s.value},qe())}}},zt=t=>{t.length>0&&(r.value="order",i.value=s.value,o.value=[...t],u.value=[...t],A(t[0]),console.log("ÂºÄÂßãÈ°∫Â∫èÊí≠ÊîæÊ≠åÂçï:",s.value?.name,"Êí≠ÊîæÊ®°Âºè: È°∫Â∫è"))},Nt=t=>{t.length>0&&(r.value="loop",i.value=s.value,o.value=[...t],u.value=[...t],A(t[0]),console.log("ÂºÄÂßãÂæ™ÁéØÊí≠ÊîæÊ≠åÂçï:",s.value?.name,"Êí≠ÊîæÊ®°Âºè: Âæ™ÁéØ"))},jt=t=>{if(t&&t.length>0){const l=Array.isArray(t)?t:s.value?.songs||[];if(l.length>0){r.value="shuffle",u.value=[...l];const y=[...l].sort(()=>Math.random()-.5);i.value=s.value,o.value=y,A(y[0]),console.log("ÂºÄÂßãÈöèÊú∫Êí≠ÊîæÊ≠åÂçï:",s.value?.name,"Êí≠ÊîæÊ®°Âºè: ÈöèÊú∫")}}},Bt=()=>{r.value==="loop"?r.value="order":r.value="loop",console.log("Êí≠ÊîæÊ®°ÂºèÂàáÊç¢‰∏∫:",r.value==="loop"?"Âæ™ÁéØ":"È°∫Â∫è")},Rt=t=>{if(s.value){s.value.songs=t;const l=n.value.findIndex(y=>y.id===s.value.id);l!==-1&&(n.value[l].songs=t,n.value[l].updatedAt=new Date().toISOString(),qe()),i.value?.id===s.value.id&&(o.value=t),console.log("Ê≠åÂçïÈ°∫Â∫èÂ∑≤Êõ¥Êñ∞:",s.value.name)}},Et=t=>{Je.value=t},it=t=>{ie.value=t},Ot=t=>({library:"ÊàëÁöÑÈü≥‰πê",favorites:"ÊàëÂñúÊ¨¢ÁöÑ",recent:"ÈöèÊú∫Ê≠åÊõ≤",settings:"ËÆæÁΩÆ","online-music":"Âú®Á∫øÈü≥‰πê"})[t]||"Êú™Áü•È°µÈù¢";Ce(()=>B.value?D.value/B.value*100:0);const rt=()=>{if(c.value.length===0){Me.value=[];return}const t=[...c.value],l=Math.min(15,t.length),y=[];for(let C=0;C<l;C++){const E=Math.floor(Math.random()*t.length);y.push(t[E]),t.splice(E,1)}Me.value=y,console.log(`ÁîüÊàê‰∫Ü ${y.length} È¶ñÈöèÊú∫Ê≠åÊõ≤`)},qt=()=>{rt()},Vt=()=>{c.value.length>0&&rt()},Ht=async t=>{console.log("Êé•Êî∂Âà∞‰∏ä‰º†ÁöÑÊñá‰ª∂:",t);const l=t.filter(C=>C.type==="audio"),y=t.filter(C=>C.type==="image");console.log("Èü≥È¢ëÊñá‰ª∂Êï∞Èáè:",l.length,"ÂõæÁâáÊñá‰ª∂Êï∞Èáè:",y.length);try{await V.init();for(const C of l){const E=ne(),le=`uploaded_${E}.${C.file.name.split(".").pop()}`;await V.saveFile(C.file,"songs",le);let pe=null;if(C.selectedCover){const _e=y.find(tt=>tt.id===C.selectedCover);if(_e){pe=`uploaded_${ne()}.${_e.file.name.split(".").pop()}`,await V.saveFile(_e.file,"covers",pe);const as=URL.createObjectURL(_e.file);P.value.set(pe,as)}}let ke=null;if(C.lyricsContent){ke=`lyrics_${ne()}.lrc`;const tt=new Blob([C.lyricsContent],{type:"text/plain"});await V.saveFile(tt,"lyrics",ke)}const Ve={id:parseInt(E,36),title:C.title.trim(),artist:C.artist.trim(),duration:C.duration,song:le,cover:pe,lrcFile:ke,isUploaded:!0,isFavorite:!1};console.log("ÂàõÂª∫ÁöÑÊñ∞Ê≠åÊõ≤ÂØπË±°:",Ve),console.log("Ê≠åËØçÊñá‰ª∂Âêç:",Ve.lrcFile),c.value.push(Ve)}Xe(),console.log("Êñá‰ª∂Â∑≤‰øùÂ≠òÂà∞ÈùôÊÄÅËµÑÊ∫êÁÆ°ÁêÜÂô®")}catch(C){console.error("Êñá‰ª∂‰øùÂ≠òÂ§±Ë¥•:",C)}},Gt=async t=>{try{t.isUploaded&&(t.song&&f.value.has(t.song)&&(URL.revokeObjectURL(f.value.get(t.song)),f.value.delete(t.song)),t.cover&&f.value.has(t.cover)&&(URL.revokeObjectURL(f.value.get(t.cover)),f.value.delete(t.cover)),t.song&&await V.deleteFile("songs",t.song),t.cover&&await V.deleteFile("covers",t.cover),t.lrc&&await V.deleteFile("lyrics",t.lrc));const l=c.value.findIndex(y=>y.id===t.id);if(l!==-1&&c.value.splice(l,1),n.value.forEach(y=>{const C=y.songs.findIndex(E=>E.id===t.id);C!==-1&&(y.songs.splice(C,1),console.log(`‰ªéÊ≠åÂçï "${y.name}" ‰∏≠ÁßªÈô§Ê≠åÊõ≤ "${t.title}"`))}),p.value?.id===t.id&&(p.value=null,x.value=!1,z.value&&(z.value.pause(),z.value.src="")),i.value){const y=o.value.findIndex(E=>E.id===t.id);y!==-1&&o.value.splice(y,1);const C=u.value.findIndex(E=>E.id===t.id);C!==-1&&u.value.splice(C,1)}Xe(),qe(),console.log("Ê≠åÊõ≤Â∑≤Âà†Èô§:",t.title)}catch(l){throw console.error("Âà†Èô§Ê≠åÊõ≤Â§±Ë¥•:",l),l}},Xe=()=>{const t=c.value.map(l=>({...l,songUrl:l.isUploaded?f.value.get(l.song):null,coverUrl:l.isUploaded&&l.cover?f.value.get(l.cover):null}));localStorage.setItem(St,JSON.stringify(t))},Wt=async()=>{try{const t=localStorage.getItem(St);if(t){const l=JSON.parse(t);await V.init();for(const y of l)y.isUploaded&&y.cover&&y.cover.startsWith("uploaded_")&&L(y.cover),delete y.songUrl,delete y.coverUrl,y.isFavorite===void 0&&(y.isFavorite=!1),c.value.push(y)}}catch(t){console.error("Âä†ËΩΩÊí≠ÊîæÂàóË°®Â§±Ë¥•:",t)}},yt=t=>{if(!(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA"))switch(t.code){case"Space":t.preventDefault(),R();break;case"ArrowLeft":if(t.preventDefault(),t.shiftKey)ee(Math.max(0,D.value-10));else{const C=Math.max(0,W.value-5);m(C)}break;case"ArrowRight":if(t.preventDefault(),t.shiftKey)ee(Math.min(B.value,D.value+10));else{const C=Math.min(100,W.value+5);m(C)}break;case"ArrowUp":t.preventDefault();const l=Math.min(100,W.value+5);m(l);break;case"ArrowDown":t.preventDefault();const y=Math.max(0,W.value-5);m(y);break;case"KeyF":t.ctrlKey&&(t.preventDefault(),h.value=!0);break;case"Escape":t.preventDefault(),Re.value&&X();break;case"KeyJ":t.preventDefault(),Z(Math.max(0,D.value-10));break;case"KeyL":t.preventDefault(),Z(Math.min(B.value,D.value+10));break;case"KeyK":t.preventDefault(),R();break;case"KeyM":t.preventDefault(),fe();break;case"KeyP":t.preventDefault(),p.value&&De();break;case"Comma":if(t.shiftKey){t.preventDefault();const C=[.5,.75,1,1.25,1.5,2],E=C.indexOf(Le.value);E>0&&v(C[E-1])}break;case"Period":if(t.shiftKey){t.preventDefault();const C=[.5,.75,1,1.25,1.5,2],E=C.indexOf(Le.value);E<C.length-1&&v(C[E+1])}break;case"Slash":t.shiftKey&&(t.preventDefault(),$.value=!0);break}};We(async()=>{await O(),await Wt(),Tt(),Vt(),document.addEventListener("keydown",yt)}),pt(()=>{document.removeEventListener("keydown",yt)}),Ge(c,()=>{c.value.length>0?(Xe(),rt()):Me.value=[]},{deep:!0});const Zt=()=>{console.log("ÈùôÊÄÅËµÑÊ∫êÂ∑≤Êõ¥Êîπ")},ht=t=>{if(!t||isNaN(t))return"0:00";const l=Math.floor(t/60),y=Math.floor(t%60);return`${l}:${y.toString().padStart(2,"0")}`},mt=Ce(()=>!B.value||B.value===0?0:Math.min(D.value/B.value*100,100)),ct=b(null),Yt=t=>{if(!ct.value||!B.value)return;const l=ct.value.getBoundingClientRect(),y=t.clientX-l.left,C=Math.max(0,Math.min(1,y/l.width));Z(C)},dt=b(null),Kt=t=>{if(!dt.value)return;const l=dt.value.getBoundingClientRect(),y=t.clientX-l.left,C=Math.max(0,Math.min(100,y/l.width*100));m(C),oe.value&&C>0&&fe()},Qt=b(null),Ue=b(null),et=b(-1),Qe=b([]),ft=Ce(()=>p.value?.lrcFile&&Qe.value.length>0),Jt=t=>{if(!t)return[];const l=t.split(`
`),y=[];return l.forEach(C=>{const E=C.replace(/\r/g,"").trim(),le=E.match(/\[(\d{2}):(\d{2}):(\d{2})\](.*)/)||E.match(/\[(\d{2}):(\d{2})(?:\.(\d{2,3}))?\](.*)/);if(le){let pe,ke,Ve,_e;le[0].includes(":")&&le[3]&&!le[3].includes(".")?(pe=parseInt(le[1]),ke=parseInt(le[2]),Ve=parseInt(le[3])*10,_e=le[4].trim()):(pe=parseInt(le[1]),ke=parseInt(le[2]),Ve=le[3]?parseInt(le[3].padEnd(3,"0")):0,_e=le[4].trim());const tt=pe*60+ke+Ve/1e3;_e&&y.push({time:tt,text:_e})}}),y.sort((C,E)=>C.time-E.time)},Xt=t=>{for(let l=Qe.value.length-1;l>=0;l--)if(t>=Qe.value[l].time)return l;return-1},es=async t=>{if(!Ue.value||t<0||!Qe.value.length)return;await vt();const l=Ue.value.querySelector(`[data-lyric-index="${t}"]`);if(l&&Ue.value){const y=Ue.value,C=y.clientHeight,E=l.offsetTop,le=l.clientHeight,pe=E-C/2+le/2,ke=y.scrollTop;Math.abs(ke-pe)>10&&y.scrollTo({top:Math.max(0,pe),behavior:"smooth"})}},ts=t=>{ee(t)},ss=async t=>{try{if(!t||!V)return"";const l=await V.getFileBlob("lyrics",t);return l?await l.text():""}catch(l){return console.error("Âä†ËΩΩÊ≠åËØçÊñá‰ª∂Â§±Ë¥•:",l),""}},ls=()=>{ve.value=!1,z.value&&(z.value.pause(),x.value=!1),p.value=null,D.value=0,B.value=0},os=()=>{ve.value=!1,Se.value=!1};return Ge(()=>p.value?.lrcFile,async t=>{if(t){const l=await ss(t);Qe.value=Jt(l)}else Qe.value=[];et.value=-1,await vt(),Ue.value&&(Ue.value.scrollTop=0)},{immediate:!0}),Ge(()=>D.value,t=>{if(!ft.value)return;const l=Xt(t);l!==et.value&&(et.value=l,es(l))}),Ge(()=>p.value,()=>{et.value=-1,Ue.value&&(Ue.value.scrollTop=0)}),(t,l)=>(d(),g("div",Ur,[Te(Zs,{"song-count":c.value.length,"favorite-count":st.value.length,"playlist-count":n.value.length,"current-view":ie.value,"is-dark-mode":He(T),onNavigate:it,onShowAddMusic:l[0]||(l[0]=y=>F.value=!0),onShowResourceManager:l[1]||(l[1]=y=>U.value=!0),onShowSearch:l[2]||(l[2]=y=>h.value=!0),onSidebarCollapsed:Et,onToggleTheme:He(K),onShowSettings:l[3]||(l[3]=y=>w.value=!0)},null,8,["song-count","favorite-count","playlist-count","current-view","is-dark-mode","onToggleTheme"]),e("div",{class:G(["main-content",{"sidebar-collapsed":Je.value,"player-visible":Se.value}])},[ie.value==="library"?(d(),g("div",Tr,[e("div",Fr,[l[17]||(l[17]=e("div",{class:"header-title"},[e("span",{class:"title-icon"},"üé∂"),e("h1",null,"ÊàëÁöÑÈü≥‰πê")],-1)),e("div",zr,[e("button",{class:"add-music-btn",onClick:l[4]||(l[4]=y=>F.value=!0)},l[16]||(l[16]=[e("span",{class:"btn-icon"},"‚ûï",-1),H(" Ê∑ªÂä†Èü≥‰πê ")]))])]),e("div",Nr,[c.value.length>0?(d(),$e(gt,{key:0,playlist:c.value,"current-song":p.value,"is-playing":x.value,"get-cover-url":I,playlists:n.value,onPlaySong:A,onToggleFavorite:re,onDeleteSong:Y,onAddToPlaylist:nt,onEditSong:ge},null,8,["playlist","current-song","is-playing","playlists"])):(d(),g("div",jr,[l[19]||(l[19]=e("div",{class:"empty-icon"},"üéµ",-1)),l[20]||(l[20]=e("h3",null,"ËøòÊ≤°ÊúâÊ∑ªÂä†‰ªª‰ΩïÈü≥‰πê",-1)),l[21]||(l[21]=e("p",null,'ÁÇπÂáª"Ê∑ªÂä†Èü≥‰πê"ÊåâÈíÆÂºÄÂßã‰∏ä‰º†ÊÇ®ÁöÑÈü≥‰πêÊñá‰ª∂',-1)),e("button",{class:"empty-add-btn",onClick:l[5]||(l[5]=y=>F.value=!0)},l[18]||(l[18]=[e("span",{class:"btn-icon"},"‚ûï",-1),H(" Ê∑ªÂä†Èü≥‰πê ")]))]))])])):ie.value==="favorites"?(d(),g("div",Br,[Te(jn,{playlist:c.value,"current-song":p.value,"is-playing":x.value,"get-cover-url":I,playlists:n.value,onPlaySong:A,onToggleFavorite:re,onNavigate:it,onDeleteSong:Y,onAddToPlaylist:nt},null,8,["playlist","current-song","is-playing","playlists"])])):ie.value==="playlists"?(d(),g("div",Rr,[Te(di,{playlists:n.value,"get-cover-url":I,onCreatePlaylist:at,onUpdatePlaylist:Pt,onDeletePlaylist:Lt,onOpenPlaylist:Dt},null,8,["playlists"])])):ie.value==="playlist-detail"&&s.value?(d(),g("div",Er,[Te(ur,{playlist:s.value,"current-song":p.value,"is-playing":x.value,"get-cover-url":I,"play-mode":r.value,playlists:n.value,onPlaySong:A,onToggleFavorite:re,onRemoveSong:Ft,onEditPlaylist:Ut,onGoBack:At,onNavigate:it,onPlayOrder:zt,onPlayLoop:Nt,onShufflePlay:jt,onToggleLoop:Bt,onUpdateSongOrder:Rt,onAddToPlaylist:nt},null,8,["playlist","current-song","is-playing","play-mode","playlists"])])):ie.value==="online-music"?(d(),g("div",Or,[l[22]||(l[22]=e("div",{class:"content-header"},[e("div",{class:"header-title"},[e("span",{class:"title-icon"},"üéµ"),e("h1",null,"ÁΩëÊòì‰∫ëÈü≥‰πêÂú®Á∫øÊêúÁ¥¢")])],-1)),e("div",qr,[Te(Xa,{onSongsImported:me})])])):ie.value==="recent"?(d(),g("div",Vr,[e("div",{class:"content-header"},[l[24]||(l[24]=e("div",{class:"header-title"},[e("span",{class:"title-icon"},"üé≤"),e("h1",null,"ÈöèÊú∫Ê≠åÊõ≤")],-1)),e("div",{class:"header-actions"},[e("button",{class:"refresh-btn",onClick:qt,title:"Âà∑Êñ∞ÈöèÊú∫Ê≠åÊõ≤"},l[23]||(l[23]=[e("span",{class:"btn-icon"},"üîÑ",-1),H(" Âà∑Êñ∞ ")]))])]),e("div",Hr,[Me.value.length>0?(d(),$e(gt,{key:0,playlist:Me.value,"current-song":p.value,"is-playing":x.value,"get-cover-url":I,playlists:n.value,onPlaySong:A,onToggleFavorite:re,onDeleteSong:Y,onAddToPlaylist:nt,onEditSong:ge},null,8,["playlist","current-song","is-playing","playlists"])):(d(),g("div",Gr,[l[26]||(l[26]=e("div",{class:"empty-icon"},"üé≤",-1)),l[27]||(l[27]=e("h3",null,"ÊöÇÊó†ÈöèÊú∫Ê≠åÊõ≤",-1)),l[28]||(l[28]=e("p",null,"Èü≥‰πêÂ∫ì‰∏≠ËøòÊ≤°ÊúâÊ≠åÊõ≤ÔºåËØ∑ÂÖàÊ∑ªÂä†‰∏Ä‰∫õÈü≥‰πê",-1)),e("button",{class:"empty-add-btn",onClick:l[6]||(l[6]=y=>F.value=!0)},l[25]||(l[25]=[e("span",{class:"btn-icon"},"‚ûï",-1),H(" Ê∑ªÂä†Èü≥‰πê ")]))]))])])):(d(),g("div",Wr,[e("div",Zr,[e("h1",null,k(Ot(ie.value)),1)]),l[29]||(l[29]=e("div",{class:"content-body"},[e("div",{class:"coming-soon"},[e("div",{class:"coming-soon-icon"},"üöß"),e("h3",null,"ÂäüËÉΩÂºÄÂèë‰∏≠"),e("p",null,"ËØ•ÂäüËÉΩÊ≠£Âú®ÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖ...")])],-1))]))],2),F.value?(d(),$e(so,{key:0,onClose:l[7]||(l[7]=y=>F.value=!1),onFilesUploaded:Ht})):q("",!0),U.value?(d(),$e(Pn,{key:1,onClose:l[8]||(l[8]=y=>U.value=!1),onAssetsChanged:Zt})):q("",!0),M.value?(d(),$e(bo,{key:2,song:S.value,"get-cover-url":I,"resource-manager":He(V),onClose:l[9]||(l[9]=y=>M.value=!1),onSave:lt},null,8,["song","resource-manager"])):q("",!0),h.value?(d(),$e(zo,{key:3,"search-query":Ye.value,"search-results":Be.value,"current-song":p.value,"is-playing":x.value,"get-cover-url":I,onClose:l[10]||(l[10]=y=>h.value=!1),onSearch:_,onClearSearch:X,onPlaySong:A,onToggleFavorite:re},null,8,["search-query","search-results","current-song","is-playing"])):q("",!0),$.value?(d(),$e(jo,{key:4,onClose:l[11]||(l[11]=y=>$.value=!1)})):q("",!0),ve.value&&p.value?(d(),g("div",{key:5,class:"fullscreen-player",onClick:os},[e("div",{class:"fullscreen-content",onClick:l[14]||(l[14]=se(()=>{},["stop"]))},[e("button",{class:"close-btn",onClick:ls},l[30]||(l[30]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)])),e("div",Yr,[e("div",Kr,[e("div",Qr,[e("div",{class:G(["cd-disc",{spinning:x.value}])},[e("img",{src:I(p.value.cover,p.value.coverUrl),alt:p.value.title,class:"cd-cover"},null,8,Jr)],2)]),e("div",Xr,[e("h2",ec,k(p.value.title),1),e("p",tc,k(p.value.artist),1)])]),e("div",sc,[e("div",{class:"lyrics-container",ref_key:"lyricsContainer",ref:Qt},[ft.value?(d(),g("div",{key:0,class:"lyrics-scroll",ref_key:"lyricsScroll",ref:Ue},[(d(!0),g(ce,null,de(Qe.value,(y,C)=>(d(),g("div",{key:C,class:G(["lyric-line",{current:et.value===C,passed:C<et.value}]),"data-lyric-index":C,onClick:E=>ts(y.time)},k(y.text),11,lc))),128))],512)):(d(),g("div",oc,[l[31]||(l[31]=e("div",{class:"no-lyrics-icon"},"üéµ",-1)),e("p",null,"„Ää"+k(p.value.title)+"„ÄãÊöÇÊó†Ê≠åËØç",1),e("button",{class:"add-lyrics-btn",onClick:l[12]||(l[12]=y=>ge(p.value))}," Ê∑ªÂä†Ê≠åËØç ")]))],512)])]),e("div",ac,[e("div",nc,[e("div",ic,[e("img",{src:I(p.value.cover,p.value.coverUrl),class:"control-cover",alt:"‰∏ìËæëÂ∞ÅÈù¢"},null,8,rc),e("div",cc,[e("div",dc,k(p.value.title),1),e("div",uc,k(p.value.artist),1)]),e("button",{class:G(["favorite-btn",{"is-favorite":Oe(p.value)}]),onClick:l[13]||(l[13]=y=>re(p.value)),title:"Êî∂Ëóè"},[(d(),g("svg",vc,[e("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z",fill:Oe(p.value)?"#ff4757":"none",stroke:"currentColor","stroke-width":"2"},null,8,gc)]))],2)]),e("div",pc,[e("button",{onClick:xe,class:G({active:Ie.value}),title:"ÈöèÊú∫Êí≠Êîæ"},l[32]||(l[32]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5",stroke:"currentColor","stroke-width":"2"})],-1)]),2),e("button",{onClick:ae,title:"‰∏ä‰∏ÄÈ¶ñ"},l[33]||(l[33]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M19 20L9 12l10-8v16zM5 19V5",stroke:"currentColor","stroke-width":"2"})],-1)])),e("button",{class:"play-btn",onClick:R,title:x.value?"ÊöÇÂÅú":"Êí≠Êîæ"},[x.value?(d(),g("svg",mc,l[35]||(l[35]=[e("path",{d:"M6 4h4v16H6zM14 4h4v16h-4z",fill:"currentColor"},null,-1)]))):(d(),g("svg",hc,l[34]||(l[34]=[e("path",{d:"M8 5v14l11-7z",fill:"currentColor"},null,-1)])))],8,yc),e("button",{onClick:J,title:"‰∏ã‰∏ÄÈ¶ñ"},l[36]||(l[36]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M5 4l10 8-10 8V4zM19 5v14",stroke:"currentColor","stroke-width":"2"})],-1)])),e("button",{onClick:Ke,class:G({active:je.value}),title:"Âæ™ÁéØÊí≠Êîæ"},l[37]||(l[37]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M17 1l4 4-4 4M3 11V9a4 4 0 014-4h14M7 23l-4-4 4-4M21 13v2a4 4 0 01-4 4H3",stroke:"currentColor","stroke-width":"2"})],-1)]),2)]),e("div",fc,[e("span",bc,k(ht(D.value)),1),e("div",{class:"progress-container",onClick:Yt,ref_key:"progressContainer",ref:ct},[l[38]||(l[38]=e("div",{class:"progress-track"},null,-1)),e("div",{class:"progress-fill",style:ze({width:mt.value+"%"})},null,4),e("div",{class:"progress-thumb",style:ze({left:mt.value+"%"})},null,4)],512),e("span",wc,k(ht(B.value)),1)]),e("div",kc,[e("button",{onClick:fe,title:"ÈùôÈü≥"},[!oe.value&&W.value>50?(d(),g("svg",$c,l[39]||(l[39]=[e("path",{d:"M11 5L6 9H2v6h4l5 4V5zM19.07 4.93a10 10 0 010 14.14M15.54 8.46a5 5 0 010 7.07",stroke:"currentColor","stroke-width":"2"},null,-1)]))):!oe.value&&W.value>0?(d(),g("svg",Cc,l[40]||(l[40]=[e("path",{d:"M11 5L6 9H2v6h4l5 4V5zM15.54 8.46a5 5 0 010 7.07",stroke:"currentColor","stroke-width":"2"},null,-1)]))):(d(),g("svg",Sc,l[41]||(l[41]=[e("path",{d:"M11 5L6 9H2v6h4l5 4V5zM23 9l-6 6M17 9l6 6",stroke:"currentColor","stroke-width":"2"},null,-1)])))]),e("div",{class:"volume-slider",onClick:Kt,ref_key:"volumeSlider",ref:dt},[l[42]||(l[42]=e("div",{class:"volume-track"},null,-1)),e("div",{class:"volume-fill",style:ze({width:(oe.value?0:W.value)+"%"})},null,4),e("div",{class:"volume-thumb",style:ze({left:(oe.value?0:W.value)+"%"})},null,4)],512)])])])])])):q("",!0),p.value&&!Se.value?(d(),g("div",{key:6,class:"show-player-btn",onClick:Q,title:"ÊòæÁ§∫Êí≠ÊîæÊ†è"},[e("div",Ic,[e("img",{src:I(p.value.cover,p.value.coverUrl),class:"mini-cover",alt:"‰∏ìËæëÂ∞ÅÈù¢"},null,8,Mc),e("div",xc,[e("div",_c,k(p.value.title),1),e("div",Pc,k(p.value.artist),1)])]),e("div",Lc,[e("button",{class:"mini-play-btn",onClick:se(R,["stop"])},[x.value?(d(),g("svg",Ac,l[44]||(l[44]=[e("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},null,-1)]))):(d(),g("svg",Dc,l[43]||(l[43]=[e("path",{d:"M8 5v14l11-7z"},null,-1)])))]),e("button",{class:"show-up-btn",onClick:se(Q,["stop"])},l[45]||(l[45]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"})],-1)]))])])):q("",!0),w.value?(d(),$e(Ar,{key:7,"is-dark-mode":He(T),onClose:l[15]||(l[15]=y=>w.value=!1),onThemeChanged:N},null,8,["is-dark-mode"])):q("",!0)]))}};export{Tc as default};
